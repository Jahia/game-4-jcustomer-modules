(this.webpackJsonpquiz=this.webpackJsonpquiz||[]).push([[0],{129:function(e,t,a){},130:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(43),i=a.n(c),o=a(132),l=a(133),s=a(135),u=a(22),d=a(4),p=a.n(d),m=r.a.createContext(null),g=a(31),v=a(64),b=a(27),E=a(44),f=(a(73),a(74),a(23)),h=a(19);function S(){var e=Object(f.a)(['\n    query getQuiz($workspace: Workspace!, $id: String!, $language: String!) {\n        response: jcr(workspace: $workspace) {\n            quiz: nodeById(uuid: $id) {\n                id: uuid\n                type: primaryNodeType{\n                    value:name\n                }\n                key: property(name:"game4:quizKey"){\n                    value\n                }\n                title: displayName(language:$language)\n                subtitle: property(language:$language, name:"game4:subtitle"){\n                    value\n                }\n                description: property(language:$language,name:"game4:description"){\n                    value\n                }\n                duration: property(name:"game4:duration"){\n                    value\n                }\n                cover: property(name:"game4:cover"){\n                    node: refNode {\n                        path\n                    }\n                }\n                consents: property(name:"game4:consentType"){\n                    nodes: refNodes {\n                        id: uuid\n                        actived: property(language:$language,name:"wem:activated"){\n                            value\n                        }\n                    }\n                }\n                children{\n                    nodes {\n                        id: uuid\n                        type: primaryNodeType{\n                            value:name\n                        }\n                    }\n                },\n                btnStart: property(language:$language, name:"game4:btnStart"){\n                    value\n                },\n                btnSubmit: property(language:$language, name:"game4:btnSubmit"){\n                    value\n                },\n                btnQuestion: property(language:$language, name:"game4:btnQuestion"){\n                    value\n                },\n                btnNextQuestion: property(language:$language, name:"game4:btnNextQuestion"){\n                    value\n                },\n                btnShowResults: property(language:$language, name:"game4:btnShowResults"){\n                    value\n                },\n                btnReset: property(language:$language, name:"game4:btnReset"){\n                    value\n                },\n                consentTitle: property(language:$language, name:"game4:consentTitle"){\n                    value\n                },\n                correctAnswer: property(language:$language, name:"game4:correctAnswer"){\n                    value\n                },\n                wrongAnswer: property(language:$language, name:"game4:wrongAnswer"){\n                    value\n                }\n            }\n        }\n    }\n']);return S=function(){return e},e}var y=Object(h.b)(S()),_=a(16),O=a(25),w=a(5),N=a(24),j=a(134);function k(){var e=Object(f.a)(['\n    query getConsent($workspace: Workspace!, $id: String!, $language: String!) {\n        response: jcr(workspace: $workspace) {\n            consent: nodeById(uuid: $id) {\n                id: uuid\n                identifier:name\n                title:displayName(language:$language)\n                description: property(language:$language, name:"jcr:description"){\n                    value\n                }\n                actived: property(language:$language,name:"wem:activated"){\n                    value\n                }\n            }\n        }\n    }\n']);return k=function(){return e},e}var q=Object(h.b)(k()),D=a(26),x=a.n(D),R=function(e){var t=e.typeIdentifier,a=e.scope,n=e.status,r=new Date,c=new Date(r);c.setFullYear(c.getFullYear()+2),console.debug("syncConsentStatus status :",n),x.a.track("modifyConsent",{consent:{typeIdentifier:t,scope:a,status:n,statusDate:r.toISOString(),revokeDate:c.toISOString()}})},A=function(e){var t=e.id,a=e.quizState,n=e.quizDispatch,c=a.consents.filter((function(e){return e.id===t})),i=Object(_.a)(c,1)[0],o=void 0===i?{}:i,l=r.a.useContext(m).state,s=l.jContent,d=l.cxs,g=s.gql_variables,v=s.scope,b=s.consent_status,E=Object.assign(g,{id:t}),f=Object(u.a)(q,{variables:E}),h=f.loading,S=f.error,y=f.data;if(r.a.useEffect((function(){if(!1===h&&y){var e=p()(y,"response.consent",{});n({case:"DATA_READY_CONSENT",payload:{consentData:e,scope:v,cxs:d,consent_status:b}})}}),[h,y]),h)return r.a.createElement("p",null,"Loading...");if(S)return r.a.createElement("p",null,"Error :(");console.debug("*** paint consent : ",t);return r.a.createElement("li",null,!o.granted&&r.a.createElement("div",{className:"consent-to-grant"},r.a.createElement(j.a.Check,{custom:!0,type:"checkbox",name:o.identifier,id:o.id,label:o.title,onChange:function(e){n({case:"TOGGLE_CONSENT",payload:{id:e.target.id}})},checked:o.checked}),r.a.createElement("i",null,o.description)),o.granted&&r.a.createElement("p",{className:"consent-granted"},r.a.createElement(N.a,{icon:["fas","check"]}),o.title,r.a.createElement(N.a,{className:"consent-denied",icon:["fas","ban"],onClick:function(){return function(e){R({scope:v,typeIdentifier:e.identifier,status:b.DENIED}),n({case:"DENIED_CONSENT",payload:{id:e.id}})}(o)}}),r.a.createElement("i",null,o.description)))},T=function(e){return Object(w.a)(Object(w.a)({},e),{},{consents:[]})},z=function(e){var t=e.showNext,a=e.workspace,n=e.consents;if(t&&"LIVE"!==a)return!0;var r=n.filter((function(e){return e.checked||e.granted}));return n.length===r.length};function I(e,t){var a=t.payload;switch(t.case){case"DATA_READY_CONSENT":var n=e.consents,r=a.consentData,c=a.scope,i=a.cxs,o=a.consent_status;console.debug("[QUIZ] DATA_READY_CONSENT -> consentData :",r);var l=p()(r,"identifier"),s='consents["'.concat(c,"/").concat(l,'"]'),u=p()(i,"".concat(s,".status")),d=p()(i,"".concat(s,".revokeDate")),m=o.GRANTED===u&&Date.now()<Date.parse(d);return n=[].concat(Object(O.a)(n),[{id:p()(r,"id"),title:p()(r,"title"),description:p()(r,"description.value"),actived:JSON.parse(p()(r,"actived.value",!1)),checked:!1,identifier:l,granted:m}]),Object(w.a)(Object(w.a)({},e),{},{consents:n,enableStartBtn:z(Object(w.a)(Object(w.a)({},e),{},{consents:n}))});case"DENIED_CONSENT":var g=e.consents,v=a.id;return console.debug("[QUIZ] DENIED_CONSENT -> id :",v),Object(w.a)(Object(w.a)({},e),{},{consents:g.map((function(e){return e.id===v?Object(w.a)(Object(w.a)({},e),{},{granted:!1}):e})),enableStartBtn:!1});case"TOGGLE_CONSENT":var b=e.consents,E=a.id;return console.debug("[QUIZ] TOGGLE_CONSENT -> id :",E),b=b.map((function(e){return e.id===E?Object(w.a)(Object(w.a)({},e),{},{checked:!e.checked}):e})),Object(w.a)(Object(w.a)({},e),{},{consents:b,enableStartBtn:z(Object(w.a)(Object(w.a)({},e),{},{consents:b}))});default:throw new Error("[QUIZ] action case '".concat(t.case,"' is unknown "))}}var C=function(e){var t=r.a.useContext(m),a=t.state,n=t.dispatch,c=a.quiz,i=a.showNext,o=a.currentSlide,l=a.jContent,u=a.cxs,d=l.files_endpoint,p=l.consent_status,g=l.scope,v=l.gql_variables,b=l.language_bundle,E=r.a.useReducer(I,{enableStartBtn:i&&"LIVE"!==v.workspace,workspace:v.workspace,showNext:i},T),f=Object(_.a)(E,2),h=f[0],S=f[1];console.debug("*** paint quiz : ",c.title);var y=o===c.id;return r.a.createElement("div",{className:"game4-quiz__item show-overlay ".concat(y?"active":""," ")},c.cover&&r.a.createElement("img",{className:"d-block w-100",src:"".concat(d).concat(encodeURI(c.cover)),alt:c.title}),r.a.createElement("div",{className:"game4-quiz__caption"},r.a.createElement("h2",{className:"text-uppercase"},c.title,r.a.createElement("span",{className:"subtitle"},c.subtitle)),r.a.createElement("div",{className:"duration"},r.a.createElement(N.a,{icon:["far","clock"]}),c.duration),r.a.createElement("div",{className:"lead",dangerouslySetInnerHTML:{__html:c.description}}),r.a.createElement(s.a,{variant:"game4-quiz",onClick:function(){h.consents.forEach((function(e){e.granted||R({scope:g,typeIdentifier:e.identifier,status:p.GRANTED})})),n({case:"NEXT_SLIDE"})},disabled:!h.enableStartBtn},b&&b.btnStart)),c.consents.length>0&&u&&r.a.createElement("div",{className:"game4-quiz__consent"},r.a.createElement("h5",null,b&&b.consentTitle),r.a.createElement("ul",null,c.consents.map((function(e){return e.actived?r.a.createElement(A,{key:e.id,id:e.id,quizState:h,quizDispatch:S}):r.a.createElement(r.a.Fragment,null)})))))};function $(){var e=Object(f.a)(['\n    query getQna($workspace: Workspace!, $id: String!, $language: String!) {\n        response: jcr(workspace: $workspace) {\n            qna: nodeById(uuid: $id) {\n                id: uuid\n                title:displayName(language:$language)\n                question: property(language:$language, name:"game4:question"){\n                    value\n                }\n                help: property(language:$language,name:"game4:help"){\n                    value\n                }\n                nbExpectedAnswer: property(name:"game4:nbExpectedAnswer"){\n                    value\n                }\n                answers: property(language:$language,name:"game4:answers"){\n                    values\n                }\n                randomSelection: property(name:"game4:randomSelection"){\n                    value\n                }\n                notUsedForScore: property(name:"game4:notUsedForScore"){\n                    value\n                }\n                cover: property(name:"game4:cover"){\n                    node: refNode {\n                        path\n                    }\n                }\n                jExpField2Map: property(name:"game4:jExpProperty"){\n                    value\n                }\n\n            }\n        }\n    }\n']);return $=function(){return e},e}var L=Object(h.b)($()),Q=function(e){var t=e.qna,a=e.qnaDispatch,n=e.id,c=t.answers.filter((function(e){return e.id===n})),i=Object(_.a)(c,1)[0],o=i.valid||!!t.notUsedForScore&&i.checked;return r.a.createElement("li",{className:i.checked?"checked":""},r.a.createElement("div",{className:"result ".concat(o?"valid":"")},o&&r.a.createElement(N.a,{icon:["fas","check"]}),!o&&r.a.createElement(N.a,{icon:["fas","times"]})),r.a.createElement(j.a.Check,{custom:!0,type:t.inputType,name:t.id,id:i.id,label:i.label,onChange:function(){return a({case:"TOGGLE_ANSWER",payload:{answer:i}})},checked:i.checked}))};function U(e,t){var a="";t.indexOf("a")>-1&&(a+="abcdefghijklmnopqrstuvwxyz"),t.indexOf("A")>-1&&(a+="ABCDEFGHIJKLMNOPQRSTUVWXYZ"),t.indexOf("#")>-1&&(a+="0123456789"),t.indexOf("!")>-1&&(a+="~`!@#$%^&*()_+-={}[]:\";'<>?,./|\\");for(var n="",r=e;r>0;--r)n+=a[Math.floor(Math.random()*a.length)];return n}var W=function(e,t){var a=JSON.parse(p()(e,"randomSelection.value",!1)),n=p()(e,"answers.values",[]).map((function(e){var a=U(5,"#aA"),n=0===e.indexOf(t);return n&&(e=e.substring(t.length+1)),{id:a,label:e,checked:!1,valid:n}}));a&&n.sort((function(e,t){return e.id>t.id}));var r=n.filter((function(e){return e.valid})).length>1?"checkbox":"radio";return{id:p()(e,"id"),title:p()(e,"title"),question:p()(e,"question.value",""),help:p()(e,"help.value",""),notUsedForScore:JSON.parse(p()(e,"notUsedForScore.value",!1)),cover:p()(e,"cover.node.path",""),jExpField2Map:p()(e,"jExpField2Map.value",""),randomSelection:a,answers:n,inputType:r}},M={enableSubmit:!1},G=function(e,t){var a=t.payload;switch(t.case){case"DATA_READY":var n=a.qnaData,r=a.quiz_validMark;return console.debug("[QNA] DATA_READY -> qnaData :",n),Object(w.a)(Object(w.a)({},e),W(n,r));case"TOGGLE_ANSWER":var c=a.answer;console.debug("[QNA] TOGGLE_ANSWER -> answer :",c);var i=e.answers;"radio"===e.inputType&&(i=i.map((function(e){return Object(w.a)(Object(w.a)({},e),{},{checked:!1})})));var o=(i=i.map((function(e){return e.id===c.id?Object(w.a)(Object(w.a)({},e),{},{checked:!e.checked}):e}))).filter((function(e){return e.checked})).length>0;return Object(w.a)(Object(w.a)({},e),{},{answers:i,enableSubmit:o});case"RESET":var l=a.qnaData,s=a.quiz_validMark;return console.debug("[QNA] RESET -> qnaData :",l),Object(w.a)(Object(w.a)({},M),W(l,s));default:throw new Error("[QNA] action case '".concat(t.case,"' is unknown "))}},P=function(e){var t=r.a.useContext(m),a=t.state,n=t.dispatch,c=a.currentSlide,i=a.jContent,o=a.reset,l=i.gql_variables,d=i.files_endpoint,g=i.quiz_validMark,v=i.language_bundle,b=Object.assign(l,{id:e.id}),E=Object(u.a)(L,{variables:b}),f=E.loading,h=E.error,S=E.data,y=r.a.useReducer(G,M),O=Object(_.a)(y,2),w=O[0],N=O[1];if(r.a.useEffect((function(){if(!1===f&&S){var e=p()(S,"response.qna",{});N({case:"DATA_READY",payload:{qnaData:e,quiz_validMark:g}})}}),[f,S]),r.a.useEffect((function(){if(o&&S){var e=p()(S,"response.qna",{});N({case:"RESET",payload:{qnaData:e,quiz_validMark:g}})}}),[o,S]),f)return r.a.createElement("p",null,"Loading...");if(h)return r.a.createElement("p",null,"Error :(");console.debug("*** paint qna : ",w.title);var j=c===e.id;return r.a.createElement("div",{className:"game4-quiz__item show-overlay ".concat(j?"active":""," ")},w.cover&&r.a.createElement("img",{className:"d-block w-100",src:"".concat(d).concat(encodeURI(w.cover)),alt:w.title}),r.a.createElement("div",{className:"game4-quiz__caption d-none d-md-block"},r.a.createElement("fieldset",null,r.a.createElement("legend",null,w.question,r.a.createElement("i",null,w.help)),w.answers&&r.a.createElement("ol",{className:"game4-quiz__answer-list"},w.answers.map((function(e){return r.a.createElement(Q,{key:e.id,id:e.id,qna:w,qnaDispatch:N})})))),r.a.createElement(s.a,{variant:"game4-quiz",onClick:function(){if(n({case:"SHOW_RESULT",payload:{result:!!w.notUsedForScore||w.answers.filter((function(e){return e.valid})).reduce((function(e,t){return e&&t.checked}),!0)}}),w.jExpField2Map){var e=w.answers.filter((function(e){return e.checked})).reduce((function(e,t){return t.label&&t.label.length>0?t.label:null}),null);!function(e){var t=e.propertyName,a=e.propertyValue;x.a.track("updateVisitorData",{update:{propertyName:t,propertyValue:a}})}({propertyName:"properties.".concat(w.jExpField2Map),propertyValue:e})}},disabled:!w.enableSubmit},v&&v.btnSubmit)))};function F(){var e=Object(f.a)(['\n    query getWarmup($workspace: Workspace!, $id: String!, $language: String!) {\n        response: jcr(workspace: $workspace) {\n            warmup: nodeById(uuid: $id) {\n                id: uuid\n                title:displayName(language:$language)\n                subtitle: property(language:$language, name:"game4:subtitle"){\n                    value\n                }\n                content: property(language:$language,name:"game4:content"){\n                    value\n                }\n                duration: property(name:"game4:qnaDuration"){\n                    value\n                }\n                videoLink: property(name:"game4:videoLink"){\n                    value\n                }\n                videoExtPath: property(language:$language,name:"game4:videoExtPath"){\n                    value\n                }\n                videoIntPath: property(language:$language,name:"game4:videoIntPath"){\n                    node: refNode {\n                        path\n                    }\n                }\n                cover: property(name:"game4:masterQnaCover"){\n                    node: refNode {\n                        path\n                    }\n                }\n                children{\n                    nodes {\n                        id: uuid\n                        type: primaryNodeType{\n                            value:name\n                        }\n                    }\n                }\n    \n            }\n        }\n    }\n']);return F=function(){return e},e}var B=Object(h.b)(F()),H=a(62),V=a.n(H),Y=function(e){var t=e.warmupID,a=e.videoURL,c=r.a.useContext(m).state.quiz,i=Object(n.useRef)(null),o=function(e){var a=e.status;!function(e){var t=e.content,a=e.parent,n=e.status,r=e.player;x.a.track("video",{id:t.id,type:t.type,game4Quiz:{id:t.id,type:t.type},game4Warmup:{id:a},game4Video:{duration:r.current.getDuration(),currentTime:r.current.getCurrentTime(),status:n}})}({content:{id:c.id,type:c.type},parent:t,player:i,status:a})};return r.a.createElement("div",{className:"player-wrapper"},r.a.createElement(V.a,{ref:i,className:"react-player",url:a,controls:!0,width:"100%",height:"100%",onStart:function(){},onPlay:function(){return o({status:"started"})},onPause:function(){return o({status:"pause"})},onEnded:function(){return o({status:"end"})}}))},X=function(e){var t=r.a.useContext(m),a=t.state,n=t.dispatch,c=a.currentSlide,i=a.jContent,o=i.gql_variables,l=i.files_endpoint,d=i.language_bundle,g=Object.assign(o,{id:e.id}),v=Object(u.a)(B,{variables:g}),b=v.loading,E=v.error,f=v.data,h=r.a.useState({childNodes:[]}),S=Object(_.a)(h,2),y=S[0],O=S[1];if(r.a.useEffect((function(){if(!1===b&&f){var e=function(e,t){var a=null,n=p()(e,"videoLink.value",""),r=p()(e,"videoIntPath.node.path");return n&&(a=r?"".concat(t).concat(encodeURI(r)):p()(e,"videoExtPath.value")),{id:p()(e,"id",""),title:p()(e,"title",""),subtitle:p()(e,"subtitle.value",""),content:p()(e,"content.value",""),duration:p()(e,"duration.value",""),cover:p()(e,"cover.node.path",""),childNodes:p()(e,"children.nodes",[]).map((function(e){return{id:p()(e,"id"),type:p()(e,"type.value")}})),video:a}}(p()(f,"response.warmup",{}),l);n({case:"ADD_SLIDES",payload:{slides:e.childNodes.map((function(e){return e.id})),parentSlide:e.id}}),O(e)}}),[b,f]),b)return r.a.createElement("p",null,"Loading...");if(E)return r.a.createElement("p",null,"Error :(");console.debug("*** paint warmup : ",y.title);var w=c===e.id;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"game4-quiz__item show-overlay ".concat(w?"active":""," ")},y.cover&&r.a.createElement("img",{className:"d-block w-100",src:"".concat(l).concat(encodeURI(y.cover)),alt:y.title}),r.a.createElement("div",{className:"game4-quiz__caption d-none d-md-block"},r.a.createElement("h2",{className:"text-uppercase"},y.title,r.a.createElement("span",{className:"subtitle"},y.subtitle)),r.a.createElement("div",{className:"lead",dangerouslySetInnerHTML:{__html:y.content}}),null!=y.video&&r.a.createElement("div",null,r.a.createElement(Y,{videoURL:y.video,warmupID:y.id})),r.a.createElement(s.a,{variant:"game4-quiz",onClick:function(){return n({case:"NEXT_SLIDE"})}},d&&d.btnQuestion))),y.childNodes.map((function(e){return r.a.createElement(P,{key:e.id,id:e.id})})))},Z=a(63),J=function(e){var t=r.a.useContext(m),a=t.state,n=t.dispatch,c=a.quiz,i=a.currentSlide,o=a.score,l=a.scoreIndex,u=a.jContent,d=u.files_endpoint,p=u.language_bundle,g=i===l;return r.a.createElement("div",{className:"game4-quiz__item show-overlay ".concat(g?"active":""," ")},c.cover&&r.a.createElement("img",{className:"d-block w-100",src:"".concat(d).concat(encodeURI(c.cover)),alt:c.title}),r.a.createElement("div",{className:"game4-quiz__caption d-none d-md-block"},r.a.createElement("h2",{className:"text-uppercase"},c.title,r.a.createElement("span",{className:"subtitle"},c.subtitle)),r.a.createElement("div",{className:"game4-quiz__score-result col-6 offset-3 col-md-4 offset-md-4 mb-5"},r.a.createElement(Z.a,{value:o,text:"".concat(o,"%")})),r.a.createElement(s.a,{variant:"game4-quiz",onClick:function(){n({case:"RESET"})}},p&&p.btnReset)))};g.b.add(v.a,E.b,b.d,E.a,b.c,b.b,b.f,b.e,b.a);var K=function(e){var t=r.a.useContext(m),a=t.state,n=t.dispatch,c=a.currentSlide,i=e.id,o=e.enabled,l=c===i;return r.a.createElement("li",{className:"".concat(l?"active":""," ").concat(o?"clickable":""),onClick:function(){o&&n({case:"SHOW_SLIDE",payload:{slide:i}})}})},ee=function(e){var t=r.a.useContext(m),a=t.state,n=t.dispatch,c=a.jContent,i=a.quiz,d=a.slideSet,g=a.currentResult,v=a.showResult,b=a.showNext,E=a.showScore,f=Object(u.a)(y,{variables:c.gql_variables}),h=f.loading,S=f.error,_=f.data;if(r.a.useEffect((function(){if(console.debug("App Quiz init !"),!1===h&&_){console.debug("App Quiz init Set Data!");var e=p()(_,"response.quiz",{}),t=p()(e,"key.value");c.language_bundle=function(e){return["btnStart","btnSubmit","btnQuestion","btnNextQuestion","btnShowResults","btnReset","consentTitle","correctAnswer","wrongAnswer"].reduce((function(t,a){return t[a]=p()(e,"".concat(a,".value")),t}),{})}(e),console.debug("jContent.language_bundle: ",c.language_bundle),n({case:"DATA_READY",payload:{quizData:e}}),"LIVE"===c.gql_variables.workspace&&function(e){var t=e.scope,a=e.url,n=e.sessionId,r=e.dispatch;x.a.initialize({"Apache Unomi":{scope:t,url:a,sessionId:n}}),x.a.ready((function(){return r({case:"ADD_CXS",payload:{cxs:window.cxs}})}))}({scope:c.scope,url:c.cdp_endpoint,sessionId:"qZ-".concat(t,"-").concat(Date.now()),dispatch:n})}}),[h,_]),h)return r.a.createElement("p",null,"Loading...");if(S)return r.a.createElement("p",null,"Error :(");return r.a.createElement(o.a,null,r.a.createElement(l.a,null,r.a.createElement("div",{className:"game4-quiz slide ".concat(v?"show-result":"")},c.language_bundle&&r.a.createElement("div",{className:"game4-quiz__header"},r.a.createElement("span",{className:"game4-quiz__header-result"},g&&c.language_bundle.correctAnswer,!g&&c.language_bundle.wrongAnswer),!E&&r.a.createElement(s.a,{variant:"game4-quiz-header",onClick:function(){return n({case:"NEXT_SLIDE"})},disabled:!b},c.language_bundle.btnNextQuestion),E&&r.a.createElement(s.a,{variant:"game4-quiz-header",onClick:function(){return n({case:"SHOW_SCORE"})},disabled:!b},c.language_bundle.btnShowResults)),r.a.createElement("ol",{className:"game4-quiz__indicators"},d.map((function(e){return r.a.createElement(K,{key:e,id:e,enabled:c.allow_indicator_browsing})}))),r.a.createElement("div",{className:"game4-quiz__inner"},r.a.createElement(C,{key:i.id}),i.childNodes.map((function(e,t){return e.type===c.cnd_type.QNA?r.a.createElement(P,{key:e.id,id:e.id}):e.type===c.cnd_type.WARMUP?r.a.createElement(X,{key:e.id,id:e.id}):r.a.createElement("p",{className:"text-danger"},"node type ",e.type," is not supported")})),r.a.createElement(J,null)))))},te=function(e){var t=e.item,a=e.errors;return r.a.createElement("div",null,r.a.createElement("h1",null,"Validation errors"),r.a.createElement("p",null,"An error occurred when validating ",r.a.createElement("b",null,t)),r.a.createElement("ul",null,a.map((function(e,t){return r.a.createElement("li",null,e.dataPath," : ",e.message)}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var ae=a(15),ne=a(65),re={QNA:"game4nt:qna",WARMUP:"game4nt:warmup"},ce={GRANTED:"GRANTED",DENIED:"DENIED",REVOKED:"REVOKED"},ie={context:{title:"context validation schema ",description:"context is an object provided by the page in charge to load the app",type:"object",properties:{host:{type:"string",format:"uri",default:"http://localhost:8080"},allow_indicator_browsing:{type:"boolean",default:!1},workspace:{type:"string",enum:["default","live"],default:"live"},scope:{type:"string",pattern:"[a-zA-Z0-9-_]+"},files_endpoint:{type:"string",format:"uri",default:"http://localhost:8080/files/live"},gql_endpoint:{type:"string",format:"uri",default:"http://localhost:8080/modules/graphql"},gql_authorization:{type:"string"},gql_variables:{type:"object",properties:{id:{type:"string"},language:{type:"string",pattern:"[a-z]{2}(?:_[A-Z]{2})?"}},required:["id","language"]},cdp_endpoint:{type:"string",format:"uri",default:"http://localhost:8181"}},required:["host","allow_indicator_browsing","workspace","scope","files_endpoint","gql_endpoint","gql_variables","cdp_endpoint"],additionalProperties:!1}},oe=new ne({useDefaults:!0}),le=function(e){return{jContent:e,quiz:{consents:[],childNodes:[]},resultSet:[],currentResult:!1,slideSet:[],currentSlide:null,showResult:!1,showNext:!1,showScore:!1,max:-1,score:0,cxs:null,reset:!1,scoreIndex:U(5,"#aA")}},se=function(e,t){var a=t.payload,n=function(e){var t=e.slideSet,a=e.max,n=e.slide;return t.indexOf(n)<a};switch(t.case){case"DATA_READY":var r=a.quizData;console.debug("[STORE] DATA_READY - quizData: ",r);var c=function(e){return{id:p()(e,"id"),type:p()(e,"type.value"),key:p()(e,"key.value",{}),title:p()(e,"title",""),subtitle:p()(e,"subtitle.value",""),description:p()(e,"description.value",""),duration:p()(e,"duration.value",""),cover:p()(e,"cover.node.path",""),consents:p()(e,"consents.nodes",[]).map((function(e){return{id:p()(e,"id"),actived:JSON.parse(p()(e,"actived.value"))}})),childNodes:p()(e,"children.nodes",[]).map((function(e){return{id:p()(e,"id"),type:p()(e,"type.value")}}))}}(r),i=[c.id];c.childNodes.forEach((function(e){return i.push(e.id)})),i.push(e.scoreIndex);var o=i.length-1;return Object(w.a)(Object(w.a)({},e),{},{quiz:c,currentSlide:c.id,slideSet:i,showNext:n({slideSet:i,max:o,slide:c.id}),max:o});case"ADD_CXS":var l=a.cxs;return console.debug("[STORE] ADD_CXS - cxs: ",l),Object(w.a)(Object(w.a)({},e),{},{cxs:l});case"ADD_SLIDES":var s=a.slides,u=a.parentSlide,d=e.slideSet;if(u&&d.includes(u)){var m,g=d.indexOf(u)+1;(m=d).splice.apply(m,[g,0].concat(Object(O.a)(s)))}else d=[].concat(Object(O.a)(d),Object(O.a)(s));var v=d.length-1;return console.debug("[STORE] ADD_SLIDE - slides: ",s," parentSlide: ",u),Object(w.a)(Object(w.a)({},e),{},{slideSet:d,showNext:n({slideSet:d,max:v,slide:e.currentSlide}),max:v});case"NEXT_SLIDE":var b=e.slideSet.indexOf(e.currentSlide),E=b+1;console.debug("[STORE] NEXT_SLIDE - currentIndex: ",b,", max : ",e.max);var f=e.currentSlide;return b<e.max&&(f=e.slideSet[E]),Object(w.a)(Object(w.a)({},e),{},{currentSlide:f,showNext:n(Object(w.a)(Object(w.a)({},e),{},{slide:f})),showResult:!1,reset:!1});case"SHOW_SLIDE":var h=a.slide;return console.debug("[STORE] SHOW_SLIDE - slide: ",h),Object(w.a)(Object(w.a)({},e),{},{currentSlide:h,showNext:n(Object(w.a)(Object(w.a)({},e),{},{slide:h}))});case"SHOW_RESULT":var S=a.result,y=e.slideSet.indexOf(e.currentSlide)===e.max-1;return console.debug("[STORE] SHOW_RESULT - currentResult: ",S),Object(w.a)(Object(w.a)({},e),{},{showScore:y,resultSet:[].concat(Object(O.a)(e.resultSet),[S]),currentResult:S,showResult:!0});case"SHOW_SCORE":console.debug("[STORE] SHOW_SCORE");var N=e.slideSet.slice(-1),j=Object(_.a)(N,1)[0],k=e.resultSet.filter((function(e){return e})).length,q=e.resultSet.length,D=Math.floor(k/q*100);return function(e){var t=e.quizKey,a=e.split,n=e.quizScore;x.a.track("setQuizScore",{score:"".concat(t).concat(a).concat(n)})}({quizKey:e.quiz.key,split:e.jContent.score_splitPattern,quizScore:D}),Object(w.a)(Object(w.a)({},e),{},{currentSlide:j,showNext:n(Object(w.a)(Object(w.a)({},e),{},{slide:j})),showResult:!1,score:D});case"RESET":console.debug("[STORE] RESET");var R=e.slideSet.slice(0,1),A=Object(_.a)(R,1)[0];return console.debug("[STORE] RESET slideSet",e.slideSet),Object(w.a)(Object(w.a)({},e),{},{currentSlide:A,resultSet:[],currentResult:!1,reset:!0});default:throw new Error("[STORE] action case '".concat(t.case,"' is unknown "))}},ue=function(e){var t=r.a.useReducer(se,e.jContent,le),a=Object(_.a)(t,2),n=a[0],c=a[1];return r.a.createElement(m.Provider,{value:{state:n,dispatch:c}},e.children)};a(129);window.quizUIApp=function(e,t){try{t=function(e){if(!oe.validate(ie.context,e))throw{item:"Context configuration object",errors:oe.errors};return e.gql_variables.workspace=function(e){return"default"===e?"EDIT":e.toUpperCase()}(e.workspace),e.cnd_type=re,e.consent_status=ce,e.quiz_validMark="[*]",e.score_splitPattern="::",e}(t);var a={};t.gql_authorization&&(a.Authorization=t.gql_authorization);var n=new h.a({uri:t.gql_endpoint,headers:a});i.a.render(r.a.createElement(ue,{jContent:t},r.a.createElement(ae.a,{client:n},r.a.createElement(ee,null))),document.getElementById(e))}catch(c){console.error("error : ",c),i.a.render(r.a.createElement(te,{item:c.item,errors:c.errors}),document.getElementById(e))}},"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},66:function(e,t,a){e.exports=a(130)},73:function(e,t,a){}},[[66,1,2]]]);
//# sourceMappingURL=main.a3e7e162.chunk.js.map