(this.webpackJsonpquiz=this.webpackJsonpquiz||[]).push([[0],{130:function(e,a,t){},131:function(e,a,t){"use strict";t.r(a);var n,r,i,c=t(0),l=t.n(c),o=t(43),s=t.n(o),u=t(133),d=t(134),p=t(136),m=t(20),g=t(4),v=t.n(g),E=l.a.createContext(null),b=t(26),f=t(63),y=t(29),h=t(44),S=(t(72),t(73),t(22)),w=t(21),O=Object(w.b)(n||(n=Object(S.a)(['\n    query getQuiz($workspace: Workspace!, $id: String!, $language: String!) {\n        response: jcr(workspace: $workspace) {\n            quiz: nodeById(uuid: $id) {\n                id: uuid\n                type: primaryNodeType{\n                    value:name\n                }\n                key: property(name:"game4:quizKey"){\n                    value\n                }\n                title: displayName(language:$language)\n                subtitle: property(language:$language, name:"game4:subtitle"){\n                    value\n                }\n                description: property(language:$language,name:"game4:description"){\n                    value\n                }\n                duration: property(name:"game4:duration"){\n                    value\n                }\n                media: property(language:$language,name:"wden:mediaNode",){\n                    node: refNode {\n                        id: uuid\n                        type: primaryNodeType{\n                            value:name\n                        }\n                        mixins: mixinTypes{\n                            value:name\n                        }\n                        path\n                    }\n                }\n                consents: property(name:"game4:consentType"){\n                    nodes: refNodes {\n                        id: uuid\n                        actived: property(language:$language,name:"wem:activated"){\n                            value\n                        }\n                    }\n                }\n                children{\n                    nodes {\n                        id: uuid\n                        type: primaryNodeType{\n                            value:name\n                        }\n                    }\n                },\n                btnStart: property(language:$language, name:"game4:btnStart"){\n                    value\n                },\n                btnSubmit: property(language:$language, name:"game4:btnSubmit"){\n                    value\n                },\n                btnQuestion: property(language:$language, name:"game4:btnQuestion"){\n                    value\n                },\n                btnNextQuestion: property(language:$language, name:"game4:btnNextQuestion"){\n                    value\n                },\n                btnShowResults: property(language:$language, name:"game4:btnShowResults"){\n                    value\n                },\n                btnReset: property(language:$language, name:"game4:btnReset"){\n                    value\n                },\n                consentTitle: property(language:$language, name:"game4:consentTitle"){\n                    value\n                },\n                correctAnswer: property(language:$language, name:"game4:correctAnswer"){\n                    value\n                },\n                wrongAnswer: property(language:$language, name:"game4:wrongAnswer"){\n                    value\n                }\n            }\n        }\n    }\n']))),_=t(13),N=t(27),j=t(5),D=t(24),x=t(135),k=Object(w.b)(r||(r=Object(S.a)(['\n    query getConsent($workspace: Workspace!, $id: String!, $language: String!) {\n        response: jcr(workspace: $workspace) {\n            consent: nodeById(uuid: $id) {\n                id: uuid\n                identifier:name\n                title:displayName(language:$language)\n                description: property(language:$language, name:"jcr:description"){\n                    value\n                }\n                actived: property(language:$language,name:"wem:activated"){\n                    value\n                }\n            }\n        }\n    }\n']))),q=t(28),T=t.n(q),R=function(e){var a=e.typeIdentifier,t=e.scope,n=e.status,r=new Date,i=new Date(r);i.setFullYear(i.getFullYear()+2),console.debug("syncConsentStatus status :",n),T.a.track("modifyConsent",{consent:{typeIdentifier:a,scope:t,status:n,statusDate:r.toISOString(),revokeDate:i.toISOString()}})},I=function(e){var a=e.id,t=e.quizState,n=e.quizDispatch,r=t.consents.filter((function(e){return e.id===a})),i=Object(_.a)(r,1)[0],c=void 0===i?{}:i,o=l.a.useContext(E).state,s=o.jContent,u=o.cxs,d=s.gql_variables,p=s.scope,g=s.consent_status,b=Object.assign(d,{id:a}),f=Object(m.a)(k,{variables:b}),y=f.loading,h=f.error,S=f.data;if(l.a.useEffect((function(){if(!1===y&&S){var e=v()(S,"response.consent",{});n({case:"DATA_READY_CONSENT",payload:{consentData:e,scope:p,cxs:u,consent_status:g}})}}),[y,S]),y)return l.a.createElement("p",null,"Loading...");if(h)return l.a.createElement("p",null,"Error :(");console.debug("*** paint consent : ",a);return l.a.createElement("li",null,!c.granted&&l.a.createElement("div",{className:"consent-to-grant"},l.a.createElement(x.a.Check,{custom:!0,type:"checkbox",name:c.identifier,id:c.id,label:c.title,onChange:function(e){n({case:"TOGGLE_CONSENT",payload:{id:e.target.id}})},checked:c.checked}),l.a.createElement("i",null,c.description)),c.granted&&l.a.createElement("p",{className:"consent-granted"},l.a.createElement(D.a,{icon:["fas","check"]}),c.title,l.a.createElement(D.a,{className:"consent-denied",icon:["fas","ban"],onClick:function(){return function(e){R({scope:p,typeIdentifier:e.identifier,status:g.DENIED}),n({case:"DENIED_CONSENT",payload:{id:e.id}})}(c)}}),l.a.createElement("i",null,c.description)))},A=function(e){var a=e.path,t=e.alt,n=l.a.useContext(E).state.jContent.files_endpoint;return l.a.createElement("img",{className:"d-block w-100",src:"".concat(n).concat(encodeURI(a)),alt:t})},z=t(61),C=t.n(z),$=function(e){var a=e.ownerID,t=e.videoURL,n=l.a.useContext(E).state.quiz,r=Object(c.useRef)(null),i=function(e){var t=e.status;!function(e){var a=e.content,t=e.parent,n=e.status,r=e.player;T.a.track("video",{id:a.id,type:a.type,game4Quiz:{id:a.id,type:a.type},game4Warmup:{id:t},game4Video:{duration:r.current.getDuration(),currentTime:r.current.getCurrentTime(),status:n}})}({content:{id:n.id,type:n.type},parent:a,player:r,status:t})};return l.a.createElement("div",{className:"player-wrapper"},l.a.createElement(C.a,{ref:r,className:"react-player",url:t,controls:!0,width:"100%",height:"100%",onStart:function(){},onPlay:function(){return i({status:"started"})},onPause:function(){return i({status:"pause"})},onEnded:function(){return i({status:"end"})}}))},L=function(e){var a=e.url,t=e.ownerID;return l.a.createElement($,{videoURL:a,ownerID:t})},U=Object(w.b)(i||(i=Object(S.a)(['\n    query getWidenMedia($workspace: Workspace!, $id: String!, $language: String!) {\n        response: jcr(workspace: $workspace) {\n            media: nodeById(uuid: $id) {\n                id: uuid\n                type: primaryNodeType{\n                    value:name\n                }\n                title:displayName(language:$language)\n                imageURL: property(name:"wden:templatedUrl"){\n                    value\n                }\n                videoURL: property(name:"wden:videoStreamURL"){\n                    value\n                }\n            }\n        }\n    }\n']))),W=function(e){return{id:v()(e,"id"),type:v()(e,"type.value"),imageURL:v()(e,"imageURL.value"),videoURL:v()(e,"videoURL.value")}},Q=function(e){var a=e.uuid,t=l.a.useContext(E).state.jContent.gql_variables,n=Object.assign(t,{id:a}),r=Object(m.a)(U,{variables:n}),i=r.loading,c=r.error,o=r.data,s=l.a.useState({}),u=Object(_.a)(s,2),d=u[0],p=u[1];return l.a.useEffect((function(){if(!1===i&&o){var e=W(v()(o,"response.media",{}));e.imageURL=e.imageURL.replace("{size}","1024").replace("{scale}","1").replace("{quality}","72"),p(e)}}),[i,o]),i?l.a.createElement("img",{src:"https://via.placeholder.com/".concat("1024","x768/09f/fff?text=Loading"),alt:"loading"}):c?l.a.createElement("p",null,"Error :("):l.a.createElement(l.a.Fragment,null,d&&l.a.createElement("img",{className:"d-block w-100",src:d.imageURL,alt:d.title}))},G=function(e){var a=e.uuid,t=e.ownerID,n=l.a.useContext(E).state.jContent.gql_variables,r=Object.assign(n,{id:a}),i=Object(m.a)(U,{variables:r}),c=i.loading,o=i.error,s=i.data,u=l.a.useState({}),d=Object(_.a)(u,2),p=d[0],g=d[1];return l.a.useEffect((function(){if(!1===c&&s){var e=W(v()(s,"response.media",{}));g(e)}}),[c,s]),c?l.a.createElement("p",null,"Loading..."):o?l.a.createElement("p",null,"Error :("):l.a.createElement(l.a.Fragment,null,p.videoURL&&l.a.createElement($,{videoURL:p.videoURL,ownerID:t}))},V=function(e){var a,t=e.id,n=e.type,r=e.mixins,i=e.path,c=e.sourceID,o=e.alt,s=l.a.useContext(E).state.jContent,u=s.cnd_type,d=s.files_endpoint;switch(n){case u.WIDEN_IMAGE:a=l.a.createElement(Q,{uuid:t});break;case u.WIDEN_VIDEO:a=l.a.createElement(G,{uuid:t,ownerID:c});break;case u.EXT_VIDEO:a=l.a.createElement(L,{url:i,ownerID:c});break;case u.JNT_FILE:a=r.includes(u.IMAGE)?l.a.createElement(A,{path:i,alt:o}):l.a.createElement(L,{url:d+encodeURI(i),ownerID:c});break;default:a=l.a.createElement(A,{path:i,alt:o})}return a},F=function(e){return Object(j.a)(Object(j.a)({},e),{},{consents:[]})},M=function(e){var a=e.showNext,t=e.workspace,n=e.consents;if(a&&"LIVE"!==t)return!0;var r=n.filter((function(e){return e.checked||e.granted}));return n.length===r.length};function P(e,a){var t=a.payload;switch(a.case){case"DATA_READY_CONSENT":var n=e.consents,r=t.consentData,i=t.scope,c=t.cxs,l=t.consent_status;console.debug("[QUIZ] DATA_READY_CONSENT -> consentData :",r);var o=v()(r,"identifier"),s='consents["'.concat(i,"/").concat(o,'"]'),u=v()(c,"".concat(s,".status")),d=v()(c,"".concat(s,".revokeDate")),p=l.GRANTED===u&&Date.now()<Date.parse(d);return n=[].concat(Object(N.a)(n),[{id:v()(r,"id"),title:v()(r,"title"),description:v()(r,"description.value"),actived:JSON.parse(v()(r,"actived.value",!1)),checked:!1,identifier:o,granted:p}]),Object(j.a)(Object(j.a)({},e),{},{consents:n,enableStartBtn:M(Object(j.a)(Object(j.a)({},e),{},{consents:n}))});case"DENIED_CONSENT":var m=e.consents,g=t.id;return console.debug("[QUIZ] DENIED_CONSENT -> id :",g),Object(j.a)(Object(j.a)({},e),{},{consents:m.map((function(e){return e.id===g?Object(j.a)(Object(j.a)({},e),{},{granted:!1}):e})),enableStartBtn:!1});case"TOGGLE_CONSENT":var E=e.consents,b=t.id;return console.debug("[QUIZ] TOGGLE_CONSENT -> id :",b),E=E.map((function(e){return e.id===b?Object(j.a)(Object(j.a)({},e),{},{checked:!e.checked}):e})),Object(j.a)(Object(j.a)({},e),{},{consents:E,enableStartBtn:M(Object(j.a)(Object(j.a)({},e),{},{consents:E}))});default:throw new Error("[QUIZ] action case '".concat(a.case,"' is unknown "))}}var B,X=function(e){var a=l.a.useContext(E),t=a.state,n=a.dispatch,r=t.quiz,i=t.showNext,c=t.currentSlide,o=t.jContent,s=t.cxs,u=o.consent_status,d=o.scope,m=o.gql_variables,g=o.language_bundle,v=l.a.useReducer(P,{enableStartBtn:i&&"LIVE"!==m.workspace,workspace:m.workspace,showNext:i},F),b=Object(_.a)(v,2),f=b[0],y=b[1];console.debug("*** paint quiz : ",r.title);var h=c===r.id;return l.a.createElement("div",{className:"game4-quiz__item show-overlay ".concat(h?"active":""," ")},r.media&&l.a.createElement(V,{id:r.media.id,type:r.media.type.value,mixins:r.media.mixins.map((function(e){return e.value})),path:r.media.path,alt:r.title}),l.a.createElement("div",{className:"game4-quiz__caption"},l.a.createElement("h2",{className:"text-uppercase"},r.title,l.a.createElement("span",{className:"subtitle"},r.subtitle)),l.a.createElement("div",{className:"duration"},l.a.createElement(D.a,{icon:["far","clock"]}),r.duration),l.a.createElement("div",{className:"lead",dangerouslySetInnerHTML:{__html:r.description}}),l.a.createElement(p.a,{variant:"game4-quiz",onClick:function(){f.consents.forEach((function(e){e.granted||R({scope:d,typeIdentifier:e.identifier,status:u.GRANTED})})),n({case:"NEXT_SLIDE"})},disabled:!f.enableStartBtn},g&&g.btnStart)),r.consents.length>0&&s&&l.a.createElement("div",{className:"game4-quiz__consent"},l.a.createElement("h5",null,g&&g.consentTitle),l.a.createElement("ul",null,r.consents.map((function(e){return e.actived?l.a.createElement(I,{key:e.id,id:e.id,quizState:f,quizDispatch:y}):l.a.createElement(l.a.Fragment,null)})))))},H=Object(w.b)(B||(B=Object(S.a)(['\n    query getQna($workspace: Workspace!, $id: String!, $language: String!) {\n        response: jcr(workspace: $workspace) {\n            qna: nodeById(uuid: $id) {\n                id: uuid\n                title:displayName(language:$language)\n                question: property(language:$language, name:"game4:question"){\n                    value\n                }\n                help: property(language:$language,name:"game4:help"){\n                    value\n                }\n                nbExpectedAnswer: property(name:"game4:nbExpectedAnswer"){\n                    value\n                }\n                answers: property(language:$language,name:"game4:answers"){\n                    values\n                }\n                randomSelection: property(name:"game4:randomSelection"){\n                    value\n                }\n                notUsedForScore: property(name:"game4:notUsedForScore"){\n                    value\n                }\n                media: property(language:$language,name:"wden:mediaNode",){\n                    node: refNode {\n                        id: uuid\n                        type: primaryNodeType{\n                            value:name\n                        }\n                        mixins: mixinTypes{\n                            value:name\n                        }\n                        path\n                    }\n                }\n                jExpField2Map: property(name:"game4:jExpProperty"){\n                    value\n                }\n\n            }\n        }\n    }\n']))),Y=function(e){var a=e.qna,t=e.qnaDispatch,n=e.id,r=a.answers.filter((function(e){return e.id===n})),i=Object(_.a)(r,1)[0],c=i.isAnswer||!!a.notUsedForScore&&i.checked;return l.a.createElement("li",{className:i.checked?"checked":""},l.a.createElement("div",{className:"result ".concat(c?"valid":"")},c&&l.a.createElement(D.a,{icon:["fas","check"]}),!c&&l.a.createElement(D.a,{icon:["fas","times"]})),l.a.createElement(x.a.Check,{custom:!0,type:a.inputType,name:a.id,id:i.id,label:i.label,onChange:function(){return t({case:"TOGGLE_ANSWER",payload:{answer:i}})},checked:i.checked}))};function J(e,a){var t="";a.indexOf("a")>-1&&(t+="abcdefghijklmnopqrstuvwxyz"),a.indexOf("A")>-1&&(t+="ABCDEFGHIJKLMNOPQRSTUVWXYZ"),a.indexOf("#")>-1&&(t+="0123456789"),a.indexOf("!")>-1&&(t+="~`!@#$%^&*()_+-={}[]:\";'<>?,./|\\");for(var n="",r=e;r>0;--r)n+=t[Math.floor(Math.random()*t.length)];return n}var Z,K=function(e){var a=JSON.parse(v()(e,"randomSelection.value",!1)),t=v()(e,"answers.values",[]).map((function(e){var a=JSON.parse(e);return Object(j.a)(Object(j.a)({},a),{},{id:J(5,"#aA"),checked:!1})}));a&&t.sort((function(e,a){return e.id>a.id}));var n=t.filter((function(e){return e.isAnswer})).length>1?"checkbox":"radio";return{id:v()(e,"id"),title:v()(e,"title"),question:v()(e,"question.value",""),help:v()(e,"help.value",""),notUsedForScore:JSON.parse(v()(e,"notUsedForScore.value",!1)),media:v()(e,"media.node",{}),jExpField2Map:v()(e,"jExpField2Map.value",""),randomSelection:a,answers:t,inputType:n}},ee={enableSubmit:!1},ae=function(e,a){var t=a.payload;switch(a.case){case"DATA_READY":var n=t.qnaData;return console.debug("[QNA] DATA_READY -> qnaData :",n),Object(j.a)(Object(j.a)({},e),K(n));case"TOGGLE_ANSWER":var r=t.answer;console.debug("[QNA] TOGGLE_ANSWER -> answer :",r);var i=e.answers;"radio"===e.inputType&&(i=i.map((function(e){return Object(j.a)(Object(j.a)({},e),{},{checked:!1})})));var c=(i=i.map((function(e){return e.id===r.id?Object(j.a)(Object(j.a)({},e),{},{checked:!e.checked}):e}))).filter((function(e){return e.checked})).length>0;return Object(j.a)(Object(j.a)({},e),{},{answers:i,enableSubmit:c});case"RESET":var l=t.qnaData;return console.debug("[QNA] RESET -> qnaData :",l),Object(j.a)(Object(j.a)({},ee),K(l));default:throw new Error("[QNA] action case '".concat(a.case,"' is unknown "))}},te=function(e){var a=l.a.useContext(E),t=a.state,n=a.dispatch,r=t.currentSlide,i=t.jContent,c=t.reset,o=i.gql_variables,s=i.language_bundle,u=Object.assign(o,{id:e.id}),d=Object(m.a)(H,{variables:u}),g=d.loading,b=d.error,f=d.data,y=l.a.useReducer(ae,ee),h=Object(_.a)(y,2),S=h[0],w=h[1];if(l.a.useEffect((function(){if(!1===g&&f){var e=v()(f,"response.qna",{});w({case:"DATA_READY",payload:{qnaData:e}})}}),[g,f]),l.a.useEffect((function(){if(c&&f){var e=v()(f,"response.qna",{});w({case:"RESET",payload:{qnaData:e}})}}),[c,f]),g)return l.a.createElement("p",null,"Loading...");if(b)return l.a.createElement("p",null,"Error :(");console.debug("*** paint qna : ",S.title);var O=r===e.id;return l.a.createElement("div",{className:"game4-quiz__item show-overlay ".concat(O?"active":""," ")},S.media&&l.a.createElement(V,{id:S.media.id,type:S.media.type.value,mixins:S.media.mixins.map((function(e){return e.value})),path:S.media.path,alt:S.title}),l.a.createElement("div",{className:"game4-quiz__caption d-none d-md-block"},l.a.createElement("fieldset",null,l.a.createElement("legend",null,S.question,l.a.createElement("i",null,S.help)),S.answers&&l.a.createElement("ol",{className:"game4-quiz__answer-list"},S.answers.map((function(e){return l.a.createElement(Y,{key:e.id,id:e.id,qna:S,qnaDispatch:w})})))),l.a.createElement(p.a,{variant:"game4-quiz",onClick:function(){if(S.notUsedForScore?n({case:"NEXT_SLIDE"}):n({case:"SHOW_RESULT",payload:{result:S.answers.filter((function(e){return e.isAnswer})).reduce((function(e,a){return e&&a.checked}),!0)}}),S.jExpField2Map){var e=S.answers.filter((function(e){return e.checked})).reduce((function(e,a,t){if(a.cdpValue&&a.cdpValue.length>0)if(0===t){var n=a.cdpValue;"true"===n&&(n=!0),"false"===n&&(n=!1),e=n}else e="".concat(e,", ").concat(a.cdpValue);return e}),null);!function(e){var a=e.propertyName,t=e.propertyValue;T.a.track("updateVisitorData",{update:{propertyName:a,propertyValue:t}})}({propertyName:"properties.".concat(S.jExpField2Map),propertyValue:e})}},disabled:!S.enableSubmit},s&&s.btnSubmit)))},ne=Object(w.b)(Z||(Z=Object(S.a)(['\n    query getWarmup($workspace: Workspace!, $id: String!, $language: String!) {\n        response: jcr(workspace: $workspace) {\n            warmup: nodeById(uuid: $id) {\n                id: uuid\n                title:displayName(language:$language)\n                subtitle: property(language:$language, name:"game4:subtitle"){\n                    value\n                }\n                content: property(language:$language,name:"game4:content"){\n                    value\n                }\n                duration: property(name:"game4:qnaDuration"){\n                    value\n                }\n                videoLink: property(name:"game4:videoLink"){\n                    value\n                }\n                videoExtPath: property(language:$language,name:"game4:videoExtPath"){\n                    value\n                }\n                videoIntPath: property(language:$language,name:"game4:videoIntPath"){\n                    node: refNode {\n                        id: uuid\n                        type: primaryNodeType{\n                            value:name\n                        }\n                        path\n                    }\n                }\n                media: property(language:$language,name:"wden:mediaNode",){\n                    node: refNode {\n                        id: uuid\n                        type: primaryNodeType{\n                            value:name\n                        }\n                        mixins: mixinTypes{\n                            value:name\n                        }\n                        path\n                    }\n                }\n                children{\n                    nodes {\n                        id: uuid\n                        type: primaryNodeType{\n                            value:name\n                        }\n                    }\n                }\n    \n            }\n        }\n    }\n']))),re=function(e){var a=l.a.useContext(E),t=a.state,n=a.dispatch,r=t.currentSlide,i=t.jContent,c=i.gql_variables,o=i.cnd_type,s=i.language_bundle,u=Object.assign(c,{id:e.id}),d=Object(m.a)(ne,{variables:u}),g=d.loading,b=d.error,f=d.data,y=l.a.useState({childNodes:[]}),h=Object(_.a)(y,2),S=h[0],w=h[1];if(l.a.useEffect((function(){if(!1===g&&f){var e=function(e,a){var t=null,n=v()(e,"videoLink.value",""),r=v()(e,"videoIntPath.node");return n&&(t=r||{id:null,type:{value:a.EXT_VIDEO},path:v()(e,"videoExtPath.value")}),{id:v()(e,"id",""),title:v()(e,"title",""),subtitle:v()(e,"subtitle.value",""),content:v()(e,"content.value",""),duration:v()(e,"duration.value",""),media:v()(e,"media.node",{}),childNodes:v()(e,"children.nodes",[]).map((function(e){return{id:v()(e,"id"),type:v()(e,"type.value")}})),video:t}}(v()(f,"response.warmup",{}),o);n({case:"ADD_SLIDES",payload:{slides:e.childNodes.map((function(e){return e.id})),parentSlide:e.id}}),w(e)}}),[g,f]),g)return l.a.createElement("p",null,"Loading...");if(b)return l.a.createElement("p",null,"Error :(");console.debug("*** paint warmup : ",S.title);var O=r===e.id;return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"game4-quiz__item show-overlay ".concat(O?"active":""," ")},S.media&&l.a.createElement(V,{id:S.media.id,type:S.media.type.value,mixins:S.media.mixins.map((function(e){return e.value})),path:S.media.path,alt:S.title}),l.a.createElement("div",{className:"game4-quiz__caption d-none d-md-block"},l.a.createElement("h2",{className:"text-uppercase"},S.title,l.a.createElement("span",{className:"subtitle"},S.subtitle)),l.a.createElement("div",{className:"lead",dangerouslySetInnerHTML:{__html:S.content}}),null!=S.video&&l.a.createElement("div",null,l.a.createElement(V,{id:S.video.id||null,type:S.video.type.value,path:S.video.path,sourceID:S.id})),l.a.createElement(p.a,{variant:"game4-quiz",onClick:function(){return n({case:"NEXT_SLIDE"})}},s&&s.btnQuestion))),S.childNodes.map((function(e){return l.a.createElement(te,{key:e.id,id:e.id})})))},ie=t(62),ce=function(e){var a=l.a.useContext(E),t=a.state,n=a.dispatch,r=t.quiz,i=t.currentSlide,c=t.score,o=t.scoreIndex,s=t.jContent.language_bundle,u=i===o;return l.a.createElement("div",{className:"game4-quiz__item show-overlay ".concat(u?"active":""," ")},r.media&&l.a.createElement(V,{id:r.media.id,type:r.media.type.value,mixins:r.media.mixins.map((function(e){return e.value})),path:r.media.path,alt:r.title}),l.a.createElement("div",{className:"game4-quiz__caption d-none d-md-block"},l.a.createElement("h2",{className:"text-uppercase"},r.title,l.a.createElement("span",{className:"subtitle"},r.subtitle)),l.a.createElement("div",{className:"game4-quiz__score-result col-6 offset-3 col-md-4 offset-md-4 mb-5"},l.a.createElement(ie.a,{value:c,text:"".concat(c,"%")})),l.a.createElement(p.a,{variant:"game4-quiz",onClick:function(){n({case:"RESET"})}},s&&s.btnReset)))};b.b.add(f.a,h.b,y.d,h.a,y.c,y.b,y.f,y.e,y.a);var le=function(e){var a=l.a.useContext(E),t=a.state,n=a.dispatch,r=t.currentSlide,i=e.id,c=e.enabled,o=r===i;return l.a.createElement("li",{className:"".concat(o?"active":""," ").concat(c?"clickable":""),onClick:function(){c&&n({case:"SHOW_SLIDE",payload:{slide:i}})}})},oe=function(e){var a=l.a.useContext(E),t=a.state,n=a.dispatch,r=t.jContent,i=t.quiz,c=t.slideSet,o=t.currentResult,s=t.showResult,g=t.showNext,b=t.showScore,f=Object(m.a)(O,{variables:r.gql_variables}),y=f.loading,h=f.error,S=f.data;if(l.a.useEffect((function(){if(console.debug("App Quiz init !"),!1===y&&S){console.debug("App Quiz init Set Data!");var e=v()(S,"response.quiz",{}),a=v()(e,"key.value");r.language_bundle=function(e){return["btnStart","btnSubmit","btnQuestion","btnNextQuestion","btnShowResults","btnReset","consentTitle","correctAnswer","wrongAnswer"].reduce((function(a,t){return a[t]=v()(e,"".concat(t,".value")),a}),{})}(e),console.debug("jContent.language_bundle: ",r.language_bundle),n({case:"DATA_READY",payload:{quizData:e}}),"LIVE"===r.gql_variables.workspace&&function(e){var a=e.scope,t=e.url,n=e.sessionId,r=e.dispatch;T.a.initialize({"Apache Unomi":{scope:a,url:t,sessionId:n}}),T.a.ready((function(){return r({case:"ADD_CXS",payload:{cxs:window.cxs}})}))}({scope:r.scope,url:r.cdp_endpoint,sessionId:"qZ-".concat(a,"-").concat(Date.now()),dispatch:n})}}),[y,S]),y)return l.a.createElement("p",null,"Loading...");if(h)return l.a.createElement("p",null,"Error :(");return l.a.createElement(u.a,null,l.a.createElement(d.a,null,l.a.createElement("div",{className:"game4-quiz slide ".concat(s?"show-result":"")},r.language_bundle&&l.a.createElement("div",{className:"game4-quiz__header"},l.a.createElement("span",{className:"game4-quiz__header-result"},o&&r.language_bundle.correctAnswer,!o&&r.language_bundle.wrongAnswer),!b&&l.a.createElement(p.a,{variant:"game4-quiz-header",onClick:function(){return n({case:"NEXT_SLIDE"})},disabled:!g},r.language_bundle.btnNextQuestion),b&&l.a.createElement(p.a,{variant:"game4-quiz-header",onClick:function(){return n({case:"SHOW_SCORE"})},disabled:!g},r.language_bundle.btnShowResults)),l.a.createElement("ol",{className:"game4-quiz__indicators"},c.map((function(e){return l.a.createElement(le,{key:e,id:e,enabled:r.allow_indicator_browsing})}))),l.a.createElement("div",{className:"game4-quiz__inner"},l.a.createElement(X,{key:i.id}),i.childNodes.map((function(e,a){return e.type===r.cnd_type.QNA?l.a.createElement(te,{key:e.id,id:e.id}):e.type===r.cnd_type.WARMUP?l.a.createElement(re,{key:e.id,id:e.id}):l.a.createElement("p",{className:"text-danger"},"node type ",e.type," is not supported")})),l.a.createElement(ce,null)))))},se=function(e){var a=e.item,t=e.errors;return l.a.createElement("div",null,l.a.createElement("h1",null,"Validation errors"),l.a.createElement("p",null,"An error occurred when validating ",l.a.createElement("b",null,a)),l.a.createElement("ul",null,t.map((function(e,a){return l.a.createElement("li",null,e.dataPath," : ",e.message)}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var ue=t(16),de=t(64),pe={QNA:"game4nt:qna",WARMUP:"game4nt:warmup",WIDEN_IMAGE:"wdennt:image",WIDEN_VIDEO:"wdennt:video",EXT_VIDEO:"ext:video",JNT_FILE:"jnt:file",IMAGE:"jmix:image"},me={GRANTED:"GRANTED",DENIED:"DENIED",REVOKED:"REVOKED"},ge={context:{title:"context validation schema ",description:"context is an object provided by the page in charge to load the app",type:"object",properties:{host:{type:"string",format:"uri",default:"http://localhost:8080"},allow_indicator_browsing:{type:"boolean",default:!1},workspace:{type:"string",enum:["default","live"],default:"live"},scope:{type:"string",pattern:"[a-zA-Z0-9-_]+"},files_endpoint:{type:"string",format:"uri",default:"http://localhost:8080/files/live"},gql_endpoint:{type:"string",format:"uri",default:"http://localhost:8080/modules/graphql"},gql_authorization:{type:"string"},gql_variables:{type:"object",properties:{id:{type:"string"},language:{type:"string",pattern:"[a-z]{2}(?:_[A-Z]{2})?"}},required:["id","language"]},cdp_endpoint:{type:"string",format:"uri",default:"http://localhost:8181"}},required:["host","allow_indicator_browsing","workspace","scope","files_endpoint","gql_endpoint","gql_variables","cdp_endpoint"],additionalProperties:!1}},ve=new de({useDefaults:!0}),Ee=function(e){return{jContent:e,quiz:{consents:[],childNodes:[]},resultSet:[],currentResult:!1,slideSet:[],currentSlide:null,showResult:!1,showNext:!1,showScore:!1,max:-1,score:0,cxs:null,reset:!1,scoreIndex:J(5,"#aA")}},be=function(e,a){var t=a.payload,n=function(e){var a=e.slideSet,t=e.max,n=e.slide;return a.indexOf(n)<t};switch(a.case){case"DATA_READY":var r=t.quizData;console.debug("[STORE] DATA_READY - quizData: ",r);var i=function(e){return{id:v()(e,"id"),type:v()(e,"type.value"),key:v()(e,"key.value",{}),title:v()(e,"title",""),subtitle:v()(e,"subtitle.value",""),description:v()(e,"description.value",""),duration:v()(e,"duration.value",""),media:v()(e,"media.node",{}),consents:v()(e,"consents.nodes",[]).map((function(e){return{id:v()(e,"id"),actived:JSON.parse(v()(e,"actived.value"))}})),childNodes:v()(e,"children.nodes",[]).map((function(e){return{id:v()(e,"id"),type:v()(e,"type.value")}}))}}(r),c=[i.id];i.childNodes.forEach((function(e){return c.push(e.id)})),c.push(e.scoreIndex);var l=c.length-1;return Object(j.a)(Object(j.a)({},e),{},{quiz:i,currentSlide:i.id,slideSet:c,showNext:n({slideSet:c,max:l,slide:i.id}),max:l});case"ADD_CXS":var o=t.cxs;return console.debug("[STORE] ADD_CXS - cxs: ",o),Object(j.a)(Object(j.a)({},e),{},{cxs:o});case"ADD_SLIDES":var s=t.slides,u=t.parentSlide,d=e.slideSet;if(u&&d.includes(u)){var p,m=d.indexOf(u)+1;(p=d).splice.apply(p,[m,0].concat(Object(N.a)(s)))}else d=[].concat(Object(N.a)(d),Object(N.a)(s));var g=d.length-1;return console.debug("[STORE] ADD_SLIDE - slides: ",s," parentSlide: ",u),Object(j.a)(Object(j.a)({},e),{},{slideSet:d,showNext:n({slideSet:d,max:g,slide:e.currentSlide}),max:g});case"NEXT_SLIDE":var E=e.slideSet.indexOf(e.currentSlide),b=E+1;console.debug("[STORE] NEXT_SLIDE - currentIndex: ",E,", max : ",e.max);var f=e.currentSlide;return E<e.max&&(f=e.slideSet[b]),Object(j.a)(Object(j.a)({},e),{},{currentSlide:f,showNext:n(Object(j.a)(Object(j.a)({},e),{},{slide:f})),showResult:!1,reset:!1});case"SHOW_SLIDE":var y=t.slide;return console.debug("[STORE] SHOW_SLIDE - slide: ",y),Object(j.a)(Object(j.a)({},e),{},{currentSlide:y,showNext:n(Object(j.a)(Object(j.a)({},e),{},{slide:y}))});case"SHOW_RESULT":var h=t.result,S=e.slideSet.indexOf(e.currentSlide)===e.max-1;return console.debug("[STORE] SHOW_RESULT - currentResult: ",h),Object(j.a)(Object(j.a)({},e),{},{showScore:S,resultSet:[].concat(Object(N.a)(e.resultSet),[h]),currentResult:h,showResult:!0});case"SHOW_SCORE":console.debug("[STORE] SHOW_SCORE");var w=e.slideSet.slice(-1),O=Object(_.a)(w,1)[0],D=e.resultSet.filter((function(e){return e})).length,x=e.resultSet.length,k=Math.floor(D/x*100);return function(e){var a=e.quizKey,t=e.split,n=e.quizScore;T.a.track("setQuizScore",{score:"".concat(a).concat(t).concat(n)})}({quizKey:e.quiz.key,split:e.jContent.score_splitPattern,quizScore:k}),Object(j.a)(Object(j.a)({},e),{},{currentSlide:O,showNext:n(Object(j.a)(Object(j.a)({},e),{},{slide:O})),showResult:!1,score:k});case"RESET":console.debug("[STORE] RESET");var q=e.slideSet.slice(0,1),R=Object(_.a)(q,1)[0];return console.debug("[STORE] RESET slideSet",e.slideSet),Object(j.a)(Object(j.a)({},e),{},{currentSlide:R,resultSet:[],currentResult:!1,reset:!0});default:throw new Error("[STORE] action case '".concat(a.case,"' is unknown "))}},fe=function(e){var a=l.a.useReducer(be,e.jContent,Ee),t=Object(_.a)(a,2),n=t[0],r=t[1];return l.a.createElement(E.Provider,{value:{state:n,dispatch:r}},e.children)};t(130);window.quizUIApp=function(e,a){try{a=function(e){if(!ve.validate(ge.context,e))throw{item:"Context configuration object",errors:ve.errors};return e.gql_variables.workspace=function(e){return"default"===e?"EDIT":e.toUpperCase()}(e.workspace),e.cnd_type=pe,e.consent_status=me,e.quiz_validMark="[*]",e.score_splitPattern="::",e}(a);var t={};a.gql_authorization&&(t.Authorization=a.gql_authorization);var n=new w.a({uri:a.gql_endpoint,headers:t});s.a.render(l.a.createElement(fe,{jContent:a},l.a.createElement(ue.a,{client:n},l.a.createElement(oe,null))),document.getElementById(e))}catch(r){console.error("error : ",r),s.a.render(l.a.createElement(se,{item:r.item,errors:r.errors}),document.getElementById(e))}},"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},65:function(e,a,t){e.exports=t(131)},72:function(e,a,t){}},[[65,1,2]]]);
//# sourceMappingURL=main.c7b5cbd7.chunk.js.map