(this.webpackJsonpquiz=this.webpackJsonpquiz||[]).push([[0],{131:function(e,a,n){},132:function(e,a,n){"use strict";n.r(a);var t,r,i,c=n(0),l=n.n(c),o=n(43),s=n.n(o),u=n(134),d=n(135),p=n(137),m=n(18),g=n(3),v=n.n(g),E=l.a.createContext(null),b=n(26),f=n(64),y=n(29),h=n(44),S=(n(73),n(74),n(22)),w=n(19),O=Object(w.b)(t||(t=Object(S.a)(['\n    query getQuiz($workspace: Workspace!, $id: String!, $language: String!) {\n        response: jcr(workspace: $workspace) {\n            quiz: nodeById(uuid: $id) {\n                id: uuid\n                type: primaryNodeType{\n                    value:name\n                }\n                key: property(name:"game4:quizKey"){\n                    value\n                }\n                title: displayName(language:$language)\n                subtitle: property(language:$language, name:"game4:subtitle"){\n                    value\n                }\n                description: property(language:$language,name:"game4:description"){\n                    value\n                }\n                duration: property(name:"game4:duration"){\n                    value\n                }\n                media: property(language:$language,name:"wden:mediaNode",){\n                    node: refNode {\n                        id: uuid\n                        type: primaryNodeType{\n                            value:name\n                        }\n                        mixins: mixinTypes{\n                            value:name\n                        }\n                        path\n                    }\n                }\n                consents: property(name:"game4:consentType"){\n                    nodes: refNodes {\n                        id: uuid\n                        actived: property(language:$language,name:"wem:activated"){\n                            value\n                        }\n                    }\n                }\n                personalizedResult: property(name:"game4:personalizedResultContent"){\n                    node: refNode {\n                        id: uuid\n                        type: primaryNodeType{\n                            value:name\n                        }\n                    }\n                }\n                children{\n                    nodes {\n                        id: uuid\n                        type: primaryNodeType{\n                            value:name\n                        }\n                    }\n                },\n                btnStart: property(language:$language, name:"game4:btnStart"){\n                    value\n                },\n                btnSubmit: property(language:$language, name:"game4:btnSubmit"){\n                    value\n                },\n                btnQuestion: property(language:$language, name:"game4:btnQuestion"){\n                    value\n                },\n                btnNextQuestion: property(language:$language, name:"game4:btnNextQuestion"){\n                    value\n                },\n                btnShowResults: property(language:$language, name:"game4:btnShowResults"){\n                    value\n                },\n                btnReset: property(language:$language, name:"game4:btnReset"){\n                    value\n                },\n                consentTitle: property(language:$language, name:"game4:consentTitle"){\n                    value\n                },\n                correctAnswer: property(language:$language, name:"game4:correctAnswer"){\n                    value\n                },\n                wrongAnswer: property(language:$language, name:"game4:wrongAnswer"){\n                    value\n                }\n            }\n        }\n    }\n']))),_=n(12),N=n(27),j=n(5),x=n(24),D=n(136),k=Object(w.b)(r||(r=Object(S.a)(['\n    query getConsent($workspace: Workspace!, $id: String!, $language: String!) {\n        response: jcr(workspace: $workspace) {\n            consent: nodeById(uuid: $id) {\n                id: uuid\n                identifier:name\n                title:displayName(language:$language)\n                description: property(language:$language, name:"jcr:description"){\n                    value\n                }\n                actived: property(language:$language,name:"wem:activated"){\n                    value\n                }\n            }\n        }\n    }\n']))),q=n(28),R=n.n(q),I=function(e){var a=e.typeIdentifier,n=e.scope,t=e.status,r=new Date,i=new Date(r);i.setFullYear(i.getFullYear()+2),console.debug("syncConsentStatus status :",t),R.a.track("modifyConsent",{consent:{typeIdentifier:a,scope:n,status:t,statusDate:r.toISOString(),revokeDate:i.toISOString()}})},T=function(e){var a=e.id,n=e.quizState,t=e.quizDispatch,r=n.consents.filter((function(e){return e.id===a})),i=Object(_.a)(r,1)[0],c=void 0===i?{}:i,o=l.a.useContext(E).state,s=o.jContent,u=o.cxs,d=s.gql_variables,p=s.scope,g=s.consent_status,b=Object.assign(d,{id:a}),f=Object(m.a)(k,{variables:b}),y=f.loading,h=f.error,S=f.data;if(l.a.useEffect((function(){if(!1===y&&S){var e=v()(S,"response.consent",{});t({case:"DATA_READY_CONSENT",payload:{consentData:e,scope:p,cxs:u,consent_status:g}})}}),[y,S]),y)return l.a.createElement("p",null,"Loading...");if(h)return l.a.createElement("p",null,"Error :(");console.debug("*** paint consent : ",a);return l.a.createElement("li",null,!c.granted&&l.a.createElement("div",{className:"consent-to-grant"},l.a.createElement(D.a.Check,{custom:!0,type:"checkbox",name:c.identifier,id:c.id,label:c.title,onChange:function(e){t({case:"TOGGLE_CONSENT",payload:{id:e.target.id}})},checked:c.checked}),l.a.createElement("i",null,c.description)),c.granted&&l.a.createElement("p",{className:"consent-granted"},l.a.createElement(x.a,{icon:["fas","check"]}),c.title,l.a.createElement(x.a,{className:"consent-denied",icon:["fas","ban"],onClick:function(){return function(e){I({scope:p,typeIdentifier:e.identifier,status:g.DENIED}),t({case:"DENIED_CONSENT",payload:{id:e.id}})}(c)}}),l.a.createElement("i",null,c.description)))},A=function(e){var a=e.path,n=e.alt,t=l.a.useContext(E).state.jContent.files_endpoint;return l.a.createElement("img",{className:"d-block w-100",src:"".concat(t).concat(encodeURI(a)),alt:n})},z=n(61),$=n.n(z),C=function(e){var a=e.ownerID,n=e.videoURL,t=l.a.useContext(E).state.quiz,r=Object(c.useRef)(null),i=function(e){var n=e.status;!function(e){var a=e.content,n=e.parent,t=e.status,r=e.player;R.a.track("video",{id:a.id,type:a.type,game4Quiz:{id:a.id,type:a.type},game4Warmup:{id:n},game4Video:{duration:r.current.getDuration(),currentTime:r.current.getCurrentTime(),status:t}})}({content:{id:t.id,type:t.type},parent:a,player:r,status:n})};return l.a.createElement("div",{className:"player-wrapper"},l.a.createElement($.a,{ref:r,className:"react-player",url:n,controls:!0,width:"100%",height:"100%",onStart:function(){},onPlay:function(){return i({status:"started"})},onPause:function(){return i({status:"pause"})},onEnded:function(){return i({status:"end"})}}))},L=function(e){var a=e.url,n=e.ownerID;return l.a.createElement(C,{videoURL:a,ownerID:n})},U=Object(w.b)(i||(i=Object(S.a)(['\n    query getWidenMedia($workspace: Workspace!, $id: String!, $language: String!) {\n        response: jcr(workspace: $workspace) {\n            media: nodeById(uuid: $id) {\n                id: uuid\n                type: primaryNodeType{\n                    value:name\n                }\n                title:displayName(language:$language)\n                imageURL: property(name:"wden:templatedUrl"){\n                    value\n                }\n                videoURL: property(name:"wden:videoStreamURL"){\n                    value\n                }\n            }\n        }\n    }\n']))),W=function(e){return{id:v()(e,"id"),type:v()(e,"type.value"),imageURL:v()(e,"imageURL.value"),videoURL:v()(e,"videoURL.value")}},Q=function(e){var a=e.uuid,n=l.a.useContext(E).state.jContent.gql_variables,t=Object.assign(n,{id:a}),r=Object(m.a)(U,{variables:t}),i=r.loading,c=r.error,o=r.data,s=l.a.useState({}),u=Object(_.a)(s,2),d=u[0],p=u[1];return l.a.useEffect((function(){if(!1===i&&o){var e=W(v()(o,"response.media",{}));e.imageURL=e.imageURL.replace("{size}","1024").replace("{scale}","1").replace("{quality}","72"),p(e)}}),[i,o]),i?l.a.createElement("img",{src:"https://via.placeholder.com/".concat("1024","x768/09f/fff?text=Loading"),alt:"loading"}):c?l.a.createElement("p",null,"Error :("):l.a.createElement(l.a.Fragment,null,d&&l.a.createElement("img",{className:"d-block w-100",src:d.imageURL,alt:d.title}))},V=function(e){var a=e.uuid,n=e.ownerID,t=l.a.useContext(E).state.jContent.gql_variables,r=Object.assign(t,{id:a}),i=Object(m.a)(U,{variables:r}),c=i.loading,o=i.error,s=i.data,u=l.a.useState({}),d=Object(_.a)(u,2),p=d[0],g=d[1];return l.a.useEffect((function(){if(!1===c&&s){var e=W(v()(s,"response.media",{}));g(e)}}),[c,s]),c?l.a.createElement("p",null,"Loading..."):o?l.a.createElement("p",null,"Error :("):l.a.createElement(l.a.Fragment,null,p.videoURL&&l.a.createElement(C,{videoURL:p.videoURL,ownerID:n}))},G=function(e){var a,n=e.id,t=e.type,r=e.mixins,i=e.path,c=e.sourceID,o=e.alt,s=l.a.useContext(E).state.jContent,u=s.cnd_type,d=s.files_endpoint;switch(t){case u.WIDEN_IMAGE:a=l.a.createElement(Q,{uuid:n});break;case u.WIDEN_VIDEO:a=l.a.createElement(V,{uuid:n,ownerID:c});break;case u.EXT_VIDEO:a=l.a.createElement(L,{url:i,ownerID:c});break;case u.JNT_FILE:a=r.includes(u.IMAGE)?l.a.createElement(A,{path:i,alt:o}):l.a.createElement(L,{url:d+encodeURI(i),ownerID:c});break;default:a=l.a.createElement(A,{path:i,alt:o})}return a},F=function(e){return Object(j.a)(Object(j.a)({},e),{},{consents:[]})},M=function(e){var a=e.showNext,n=e.workspace,t=e.consents;if(a&&"LIVE"!==n)return!0;var r=t.filter((function(e){return e.checked||e.granted}));return t.length===r.length};function P(e,a){var n=a.payload;switch(a.case){case"DATA_READY_CONSENT":var t=e.consents,r=n.consentData,i=n.scope,c=n.cxs,l=n.consent_status;console.debug("[QUIZ] DATA_READY_CONSENT -> consentData :",r);var o=v()(r,"identifier"),s='consents["'.concat(i,"/").concat(o,'"]'),u=v()(c,"".concat(s,".status")),d=v()(c,"".concat(s,".revokeDate")),p=l.GRANTED===u&&Date.now()<Date.parse(d);return t=[].concat(Object(N.a)(t),[{id:v()(r,"id"),title:v()(r,"title"),description:v()(r,"description.value"),actived:JSON.parse(v()(r,"actived.value",!1)),checked:!1,identifier:o,granted:p}]),Object(j.a)(Object(j.a)({},e),{},{consents:t,enableStartBtn:M(Object(j.a)(Object(j.a)({},e),{},{consents:t}))});case"DENIED_CONSENT":var m=e.consents,g=n.id;return console.debug("[QUIZ] DENIED_CONSENT -> id :",g),Object(j.a)(Object(j.a)({},e),{},{consents:m.map((function(e){return e.id===g?Object(j.a)(Object(j.a)({},e),{},{granted:!1}):e})),enableStartBtn:!1});case"TOGGLE_CONSENT":var E=e.consents,b=n.id;return console.debug("[QUIZ] TOGGLE_CONSENT -> id :",b),E=E.map((function(e){return e.id===b?Object(j.a)(Object(j.a)({},e),{},{checked:!e.checked}):e})),Object(j.a)(Object(j.a)({},e),{},{consents:E,enableStartBtn:M(Object(j.a)(Object(j.a)({},e),{},{consents:E}))});default:throw new Error("[QUIZ] action case '".concat(a.case,"' is unknown "))}}var B,H=function(e){var a=l.a.useContext(E),n=a.state,t=a.dispatch,r=n.quiz,i=n.showNext,c=n.currentSlide,o=n.jContent,s=n.cxs,u=o.consent_status,d=o.scope,m=o.gql_variables,g=o.language_bundle,v=l.a.useReducer(P,{enableStartBtn:i&&"LIVE"!==m.workspace,workspace:m.workspace,showNext:i},F),b=Object(_.a)(v,2),f=b[0],y=b[1];console.debug("*** paint quiz : ",r.title);var h=c===r.id;return l.a.createElement("div",{className:"game4-quiz__item show-overlay ".concat(h?"active":""," ")},r.media&&l.a.createElement(G,{id:r.media.id,type:r.media.type.value,mixins:r.media.mixins.map((function(e){return e.value})),path:r.media.path,alt:r.title}),l.a.createElement("div",{className:"game4-quiz__caption"},l.a.createElement("h2",{className:"text-uppercase"},r.title,l.a.createElement("span",{className:"subtitle"},r.subtitle)),l.a.createElement("div",{className:"duration"},l.a.createElement(x.a,{icon:["far","clock"]}),r.duration),l.a.createElement("div",{className:"lead",dangerouslySetInnerHTML:{__html:r.description}}),l.a.createElement(p.a,{variant:"game4-quiz",onClick:function(){f.consents.forEach((function(e){e.granted||I({scope:d,typeIdentifier:e.identifier,status:u.GRANTED})})),t({case:"NEXT_SLIDE"})},disabled:!f.enableStartBtn},g&&g.btnStart)),r.consents.length>0&&s&&l.a.createElement("div",{className:"game4-quiz__consent"},l.a.createElement("h5",null,g&&g.consentTitle),l.a.createElement("ul",null,r.consents.map((function(e){return e.actived?l.a.createElement(T,{key:e.id,id:e.id,quizState:f,quizDispatch:y}):l.a.createElement(l.a.Fragment,null)})))))},X=Object(w.b)(B||(B=Object(S.a)(['\n    query getQna($workspace: Workspace!, $id: String!, $language: String!) {\n        response: jcr(workspace: $workspace) {\n            qna: nodeById(uuid: $id) {\n                id: uuid\n                title:displayName(language:$language)\n                question: property(language:$language, name:"game4:question"){\n                    value\n                }\n                help: property(language:$language,name:"game4:help"){\n                    value\n                }\n                nbExpectedAnswer: property(name:"game4:nbExpectedAnswer"){\n                    value\n                }\n                answers: property(language:$language,name:"game4:answers"){\n                    values\n                }\n                randomSelection: property(name:"game4:randomSelection"){\n                    value\n                }\n                notUsedForScore: property(name:"game4:notUsedForScore"){\n                    value\n                }\n                media: property(language:$language,name:"wden:mediaNode",){\n                    node: refNode {\n                        id: uuid\n                        type: primaryNodeType{\n                            value:name\n                        }\n                        mixins: mixinTypes{\n                            value:name\n                        }\n                        path\n                    }\n                }\n                jExpField2Map: property(name:"game4:jExpProperty"){\n                    value\n                }\n\n            }\n        }\n    }\n']))),Y=function(e){var a=e.qna,n=e.qnaDispatch,t=e.id,r=a.answers.filter((function(e){return e.id===t})),i=Object(_.a)(r,1)[0],c=i.isAnswer||!!a.notUsedForScore&&i.checked;return l.a.createElement("li",{className:i.checked?"checked":""},l.a.createElement("div",{className:"result ".concat(c?"valid":"")},c&&l.a.createElement(x.a,{icon:["fas","check"]}),!c&&l.a.createElement(x.a,{icon:["fas","times"]})),l.a.createElement(D.a.Check,{custom:!0,type:a.inputType,name:a.id,id:i.id,label:i.label,onChange:function(){return n({case:"TOGGLE_ANSWER",payload:{answer:i}})},checked:i.checked}))};function J(e,a){var n="";a.indexOf("a")>-1&&(n+="abcdefghijklmnopqrstuvwxyz"),a.indexOf("A")>-1&&(n+="ABCDEFGHIJKLMNOPQRSTUVWXYZ"),a.indexOf("#")>-1&&(n+="0123456789"),a.indexOf("!")>-1&&(n+="~`!@#$%^&*()_+-={}[]:\";'<>?,./|\\");for(var t="",r=e;r>0;--r)t+=n[Math.floor(Math.random()*n.length)];return t}var Z,K,ee=function(e){var a=JSON.parse(v()(e,"randomSelection.value",!1)),n=v()(e,"answers.values",[]).map((function(e){var a=JSON.parse(e);return Object(j.a)(Object(j.a)({},a),{},{id:J(5,"#aA"),checked:!1})}));a&&n.sort((function(e,a){return e.id>a.id}));var t=n.filter((function(e){return e.isAnswer})).length>1?"checkbox":"radio";return{id:v()(e,"id"),title:v()(e,"title"),question:v()(e,"question.value",""),help:v()(e,"help.value",""),notUsedForScore:JSON.parse(v()(e,"notUsedForScore.value",!1)),media:v()(e,"media.node",{}),jExpField2Map:v()(e,"jExpField2Map.value",""),randomSelection:a,answers:n,inputType:t}},ae={enableSubmit:!1},ne=function(e,a){var n=a.payload;switch(a.case){case"DATA_READY":var t=n.qnaData;return console.debug("[QNA] DATA_READY -> qnaData :",t),Object(j.a)(Object(j.a)({},e),ee(t));case"TOGGLE_ANSWER":var r=n.answer;console.debug("[QNA] TOGGLE_ANSWER -> answer :",r);var i=e.answers;"radio"===e.inputType&&(i=i.map((function(e){return Object(j.a)(Object(j.a)({},e),{},{checked:!1})})));var c=(i=i.map((function(e){return e.id===r.id?Object(j.a)(Object(j.a)({},e),{},{checked:!e.checked}):e}))).filter((function(e){return e.checked})).length>0;return Object(j.a)(Object(j.a)({},e),{},{answers:i,enableSubmit:c});case"RESET":var l=n.qnaData;return console.debug("[QNA] RESET -> qnaData :",l),Object(j.a)(Object(j.a)({},ae),ee(l));default:throw new Error("[QNA] action case '".concat(a.case,"' is unknown "))}},te=function(e){var a=l.a.useContext(E),n=a.state,t=a.dispatch,r=n.currentSlide,i=n.jContent,c=n.reset,o=i.gql_variables,s=i.language_bundle,u=Object.assign(o,{id:e.id}),d=Object(m.a)(X,{variables:u}),g=d.loading,b=d.error,f=d.data,y=l.a.useReducer(ne,ae),h=Object(_.a)(y,2),S=h[0],w=h[1];if(l.a.useEffect((function(){if(!1===g&&f){var e=v()(f,"response.qna",{});w({case:"DATA_READY",payload:{qnaData:e}})}}),[g,f]),l.a.useEffect((function(){if(c&&f){var e=v()(f,"response.qna",{});w({case:"RESET",payload:{qnaData:e}})}}),[c,f]),g)return l.a.createElement("p",null,"Loading...");if(b)return l.a.createElement("p",null,"Error :(");console.debug("*** paint qna : ",S.title);var O=r===e.id;return l.a.createElement("div",{className:"game4-quiz__item show-overlay ".concat(O?"active":""," ")},S.media&&l.a.createElement(G,{id:S.media.id,type:S.media.type.value,mixins:S.media.mixins.map((function(e){return e.value})),path:S.media.path,alt:S.title}),l.a.createElement("div",{className:"game4-quiz__caption d-none d-md-block"},l.a.createElement("fieldset",null,l.a.createElement("legend",null,S.question,l.a.createElement("i",null,S.help)),S.answers&&l.a.createElement("ol",{className:"game4-quiz__answer-list"},S.answers.map((function(e){return l.a.createElement(Y,{key:e.id,id:e.id,qna:S,qnaDispatch:w})})))),l.a.createElement(p.a,{variant:"game4-quiz",onClick:function(){if(S.notUsedForScore?t({case:"NEXT_SLIDE"}):t({case:"SHOW_RESULT",payload:{result:S.answers.filter((function(e){return e.isAnswer})).reduce((function(e,a){return e&&a.checked}),!0)}}),S.jExpField2Map){var e=S.answers.filter((function(e){return e.checked})).reduce((function(e,a,n){if(a.cdpValue&&a.cdpValue.length>0)if(0===n){var t=a.cdpValue;"true"===t&&(t=!0),"false"===t&&(t=!1),e=t}else e="".concat(e,", ").concat(a.cdpValue);return e}),null);!function(e){var a=e.propertyName,n=e.propertyValue;R.a.track("updateVisitorData",{update:{propertyName:a,propertyValue:n}})}({propertyName:"properties.".concat(S.jExpField2Map),propertyValue:e})}},disabled:!S.enableSubmit},s&&s.btnSubmit)))},re=Object(w.b)(Z||(Z=Object(S.a)(['\n    query getWarmup($workspace: Workspace!, $id: String!, $language: String!) {\n        response: jcr(workspace: $workspace) {\n            warmup: nodeById(uuid: $id) {\n                id: uuid\n                title:displayName(language:$language)\n                subtitle: property(language:$language, name:"game4:subtitle"){\n                    value\n                }\n                content: property(language:$language,name:"game4:content"){\n                    value\n                }\n                duration: property(name:"game4:qnaDuration"){\n                    value\n                }\n                videoLink: property(name:"game4:videoLink"){\n                    value\n                }\n                videoExtPath: property(language:$language,name:"game4:videoExtPath"){\n                    value\n                }\n                videoIntPath: property(language:$language,name:"game4:videoIntPath"){\n                    node: refNode {\n                        id: uuid\n                        type: primaryNodeType{\n                            value:name\n                        }\n                        path\n                    }\n                }\n                media: property(language:$language,name:"wden:mediaNode",){\n                    node: refNode {\n                        id: uuid\n                        type: primaryNodeType{\n                            value:name\n                        }\n                        mixins: mixinTypes{\n                            value:name\n                        }\n                        path\n                    }\n                }\n                children{\n                    nodes {\n                        id: uuid\n                        type: primaryNodeType{\n                            value:name\n                        }\n                    }\n                }\n    \n            }\n        }\n    }\n']))),ie=function(e){var a=l.a.useContext(E),n=a.state,t=a.dispatch,r=n.currentSlide,i=n.jContent,c=i.gql_variables,o=i.cnd_type,s=i.language_bundle,u=Object.assign(c,{id:e.id}),d=Object(m.a)(re,{variables:u}),g=d.loading,b=d.error,f=d.data,y=l.a.useState({childNodes:[]}),h=Object(_.a)(y,2),S=h[0],w=h[1];if(l.a.useEffect((function(){if(!1===g&&f){var e=function(e,a){var n=null,t=v()(e,"videoLink.value",""),r=v()(e,"videoIntPath.node");return t&&(n=r||{id:null,type:{value:a.EXT_VIDEO},path:v()(e,"videoExtPath.value")}),{id:v()(e,"id",""),title:v()(e,"title",""),subtitle:v()(e,"subtitle.value",""),content:v()(e,"content.value",""),duration:v()(e,"duration.value",""),media:v()(e,"media.node",{}),childNodes:v()(e,"children.nodes",[]).map((function(e){return{id:v()(e,"id"),type:v()(e,"type.value")}})),video:n}}(v()(f,"response.warmup",{}),o);t({case:"ADD_SLIDES",payload:{slides:e.childNodes.map((function(e){return e.id})),parentSlide:e.id}}),w(e)}}),[g,f]),g)return l.a.createElement("p",null,"Loading...");if(b)return l.a.createElement("p",null,"Error :(");console.debug("*** paint warmup : ",S.title);var O=r===e.id;return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"game4-quiz__item show-overlay ".concat(O?"active":""," ")},S.media&&l.a.createElement(G,{id:S.media.id,type:S.media.type.value,mixins:S.media.mixins.map((function(e){return e.value})),path:S.media.path,alt:S.title}),l.a.createElement("div",{className:"game4-quiz__caption d-none d-md-block"},l.a.createElement("h2",{className:"text-uppercase"},S.title,l.a.createElement("span",{className:"subtitle"},S.subtitle)),l.a.createElement("div",{className:"lead",dangerouslySetInnerHTML:{__html:S.content}}),null!=S.video&&l.a.createElement("div",null,l.a.createElement(G,{id:S.video.id||null,type:S.video.type.value,path:S.video.path,sourceID:S.id})),l.a.createElement(p.a,{variant:"game4-quiz",onClick:function(){return t({case:"NEXT_SLIDE"})}},s&&s.btnQuestion))),S.childNodes.map((function(e){return l.a.createElement(te,{key:e.id,id:e.id})})))},ce=Object(w.b)(K||(K=Object(S.a)(['\n    query getPersonalizedResultContent($workspace: Workspace!, $id: String!, $language: String!,$profileId: String,$sessionId: String) {\n        response: jcr(workspace: $workspace) {\n            result: nodeById(uuid: $id) {\n                jExperience: jExperience(profileId: $profileId, sessionId: $sessionId) {\n                    variant:personalizedVariant{\n                        id: uuid\n                        title:displayName(language:$language)\n                        text:property(language:$language,name:"text"){\n                            value\n                        }\n                    }\n                }\n            }\n        }\n    }\n']))),le=n(62),oe=n.n(le),se=function(e){var a=e.id,n=e.cxs,t=l.a.useContext(E).state.jContent,r=l.a.useState({}),i=Object(_.a)(r,2),c=i[0],o=i[1],s=Object(m.a)(ce,{variables:Object.assign(t.gql_variables,{profileId:n.profileId,sessionId:n.sessionId,id:a}),fetchPolicy:"no-cache"}),u=s.loading,d=s.error,p=s.data;return l.a.useEffect((function(){if(!1===u&&p){var e=v()(p,"response.result.jExperience.variant",{});o(Object(j.a)(Object(j.a)({},e),{},{text:e.text.value}))}}),[u,p]),u?l.a.createElement("p",null,"Loading..."):d?l.a.createElement("p",null,"Error :("):(console.debug("*** paint personalized result : ",c.title),l.a.createElement("div",{className:"game4-quiz__score-result col-6 offset-3 col-md-4 offset-md-4 mb-5",dangerouslySetInnerHTML:{__html:oe.a.sanitize(c.text,{ADD_ATTR:["target"]})}}))},ue=n(63),de=function(e){var a=e.score;return console.debug("*** paint percentage result : ",a),l.a.createElement("div",{className:"game4-quiz__score-result col-6 offset-3 col-md-4 offset-md-4 mb-5"},l.a.createElement(ue.a,{value:a,text:"".concat(a,"%")}))},pe=function(e){var a=l.a.useContext(E),n=a.state,t=a.dispatch,r=n.quiz,i=n.currentSlide,c=n.score,o=n.scoreIndex,s=n.jContent,u=n.cxs,d=s.language_bundle,m=i===o;return console.log("[Score] quiz.personalizedResult.id: ",r.personalizedResult.id),l.a.createElement("div",{className:"game4-quiz__item show-overlay ".concat(m?"active":""," ")},r.media&&l.a.createElement(G,{id:r.media.id,type:r.media.type.value,mixins:r.media.mixins.map((function(e){return e.value})),path:r.media.path,alt:r.title}),l.a.createElement("div",{className:"game4-quiz__caption d-none d-md-block"},l.a.createElement("h2",{className:"text-uppercase"},r.title,l.a.createElement("span",{className:"subtitle"},r.subtitle)),r.personalizedResult.id?u?l.a.createElement(se,{id:r.personalizedResult.id,cxs:u}):l.a.createElement("p",null,"cxs is loading..."):l.a.createElement(de,{score:c}),l.a.createElement(p.a,{variant:"game4-quiz",onClick:function(){t({case:"RESET"})}},d&&d.btnReset)))};b.b.add(f.a,h.b,y.d,h.a,y.c,y.b,y.f,y.e,y.a);var me=function(e){var a=l.a.useContext(E),n=a.state,t=a.dispatch,r=n.currentSlide,i=e.id,c=e.enabled,o=r===i;return l.a.createElement("li",{className:"".concat(o?"active":""," ").concat(c?"clickable":""),onClick:function(){c&&t({case:"SHOW_SLIDE",payload:{slide:i}})}})},ge=function(e){var a=l.a.useContext(E),n=a.state,t=a.dispatch,r=n.jContent,i=n.quiz,c=n.slideSet,o=n.currentResult,s=n.showResult,g=n.showNext,b=n.showScore,f=Object(m.a)(O,{variables:r.gql_variables}),y=f.loading,h=f.error,S=f.data;if(l.a.useEffect((function(){if(console.debug("App Quiz init !"),!1===y&&S){console.debug("App Quiz init Set Data!");var e=v()(S,"response.quiz",{}),a=v()(e,"key.value");r.language_bundle=function(e){return["btnStart","btnSubmit","btnQuestion","btnNextQuestion","btnShowResults","btnReset","consentTitle","correctAnswer","wrongAnswer"].reduce((function(a,n){return a[n]=v()(e,"".concat(n,".value")),a}),{})}(e),console.debug("jContent.language_bundle: ",r.language_bundle),t({case:"DATA_READY",payload:{quizData:e}}),"LIVE"===r.gql_variables.workspace&&function(e){var a=e.scope,n=e.url,t=e.sessionId,r=e.dispatch;R.a.initialize({"Apache Unomi":{scope:a,url:n,sessionId:t}}),R.a.ready((function(){return r({case:"ADD_CXS",payload:{cxs:window.cxs}})}))}({scope:r.scope,url:r.cdp_endpoint,sessionId:"qZ-".concat(a,"-").concat(Date.now()),dispatch:t})}}),[y,S]),y)return l.a.createElement("p",null,"Loading...");if(h)return l.a.createElement("p",null,"Error :(");return l.a.createElement(u.a,null,l.a.createElement(d.a,null,l.a.createElement("div",{className:"game4-quiz slide ".concat(s?"show-result":"")},r.language_bundle&&l.a.createElement("div",{className:"game4-quiz__header"},l.a.createElement("span",{className:"game4-quiz__header-result"},o&&r.language_bundle.correctAnswer,!o&&r.language_bundle.wrongAnswer),!b&&l.a.createElement(p.a,{variant:"game4-quiz-header",onClick:function(){return t({case:"NEXT_SLIDE"})},disabled:!g},r.language_bundle.btnNextQuestion),b&&l.a.createElement(p.a,{variant:"game4-quiz-header",onClick:function(){return t({case:"SHOW_SCORE"})},disabled:!g},r.language_bundle.btnShowResults)),l.a.createElement("ol",{className:"game4-quiz__indicators"},c.map((function(e){return l.a.createElement(me,{key:e,id:e,enabled:r.allow_indicator_browsing})}))),i&&l.a.createElement("div",{className:"game4-quiz__inner"},l.a.createElement(H,{key:i.id}),i.childNodes.map((function(e,a){return e.type===r.cnd_type.QNA?l.a.createElement(te,{key:e.id,id:e.id}):e.type===r.cnd_type.WARMUP?l.a.createElement(ie,{key:e.id,id:e.id}):l.a.createElement("p",{className:"text-danger"},"node type ",e.type," is not supported")})),function(){if(console.log("[displayScore] showScore: ",b),b)return l.a.createElement(pe,null)}()))))},ve=function(e){var a=e.item,n=e.errors;return l.a.createElement("div",null,l.a.createElement("h1",null,"Validation errors"),l.a.createElement("p",null,"An error occurred when validating ",l.a.createElement("b",null,a)),l.a.createElement("ul",null,n.map((function(e,a){return l.a.createElement("li",null,e.dataPath," : ",e.message)}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Ee=n(16),be=n(65),fe={QNA:"game4nt:qna",WARMUP:"game4nt:warmup",WIDEN_IMAGE:"wdennt:image",WIDEN_VIDEO:"wdennt:video",EXT_VIDEO:"ext:video",JNT_FILE:"jnt:file",IMAGE:"jmix:image"},ye={GRANTED:"GRANTED",DENIED:"DENIED",REVOKED:"REVOKED"},he={context:{title:"context validation schema ",description:"context is an object provided by the page in charge to load the app",type:"object",properties:{host:{type:"string",format:"uri",default:"http://localhost:8080"},allow_indicator_browsing:{type:"boolean",default:!1},workspace:{type:"string",enum:["default","live"],default:"live"},scope:{type:"string",pattern:"[a-zA-Z0-9-_]+"},files_endpoint:{type:"string",format:"uri",default:"http://localhost:8080/files/live"},gql_endpoint:{type:"string",format:"uri",default:"http://localhost:8080/modules/graphql"},gql_authorization:{type:"string"},gql_variables:{type:"object",properties:{id:{type:"string"},language:{type:"string",pattern:"[a-z]{2}(?:_[A-Z]{2})?"}},required:["id","language"]},cdp_endpoint:{type:"string",format:"uri",default:"http://localhost:8181"}},required:["host","allow_indicator_browsing","workspace","scope","files_endpoint","gql_endpoint","gql_variables","cdp_endpoint"],additionalProperties:!1}},Se=new be({useDefaults:!0}),we=function(e){return{jContent:e,quiz:null,resultSet:[],currentResult:!1,slideSet:[],currentSlide:null,showResult:!1,showNext:!1,showScore:!1,max:-1,score:0,cxs:null,reset:!1,scoreIndex:J(5,"#aA")}},Oe=function(e,a){var n=a.payload,t=function(e){var a=e.slideSet,n=e.max,t=e.slide;return a.indexOf(t)<n};switch(a.case){case"DATA_READY":var r=n.quizData;console.debug("[STORE] DATA_READY - quizData: ",r);var i=function(e){return{id:v()(e,"id"),type:v()(e,"type.value"),key:v()(e,"key.value",{}),title:v()(e,"title",""),subtitle:v()(e,"subtitle.value",""),description:v()(e,"description.value",""),duration:v()(e,"duration.value",""),media:v()(e,"media.node",{}),consents:v()(e,"consents.nodes",[]).map((function(e){return{id:v()(e,"id"),actived:JSON.parse(v()(e,"actived.value"))}})),personalizedResult:{id:v()(e,"personalizedResult.node.id",null),type:v()(e,"personalizedResult.node.type.value",null)},childNodes:v()(e,"children.nodes",[]).map((function(e){return{id:v()(e,"id"),type:v()(e,"type.value")}}))}}(r),c=[i.id];i.childNodes.forEach((function(e){return c.push(e.id)})),c.push(e.scoreIndex);var l=c.length-1;return Object(j.a)(Object(j.a)({},e),{},{quiz:i,currentSlide:i.id,slideSet:c,showNext:t({slideSet:c,max:l,slide:i.id}),max:l});case"ADD_CXS":var o=n.cxs;return console.debug("[STORE] ADD_CXS - cxs: ",o),Object(j.a)(Object(j.a)({},e),{},{cxs:o});case"ADD_SLIDES":var s=n.slides,u=n.parentSlide,d=e.slideSet;if(u&&d.includes(u)){var p,m=d.indexOf(u)+1;(p=d).splice.apply(p,[m,0].concat(Object(N.a)(s)))}else d=[].concat(Object(N.a)(d),Object(N.a)(s));var g=d.length-1;return console.debug("[STORE] ADD_SLIDE - slides: ",s," parentSlide: ",u),Object(j.a)(Object(j.a)({},e),{},{slideSet:d,showNext:t({slideSet:d,max:g,slide:e.currentSlide}),max:g});case"NEXT_SLIDE":var E=e.slideSet.indexOf(e.currentSlide),b=E+1;console.debug("[STORE] NEXT_SLIDE - currentIndex: ",E,", max : ",e.max);var f=e.currentSlide;E<e.max&&(f=e.slideSet[b]);var y=E===e.max-1;return Object(j.a)(Object(j.a)({},e),{},{currentSlide:f,showNext:t(Object(j.a)(Object(j.a)({},e),{},{slide:f})),showResult:!1,showScore:y,reset:!1});case"SHOW_SLIDE":var h=n.slide;return console.debug("[STORE] SHOW_SLIDE - slide: ",h),Object(j.a)(Object(j.a)({},e),{},{currentSlide:h,showNext:t(Object(j.a)(Object(j.a)({},e),{},{slide:h}))});case"SHOW_RESULT":var S=n.result,w=e.slideSet.indexOf(e.currentSlide)===e.max-1;return console.debug("[STORE] SHOW_RESULT - currentResult: ",S),Object(j.a)(Object(j.a)({},e),{},{showScore:w,resultSet:[].concat(Object(N.a)(e.resultSet),[S]),currentResult:S,showResult:!0});case"SHOW_SCORE":console.debug("[STORE] SHOW_SCORE");var O=e.slideSet.slice(-1),x=Object(_.a)(O,1)[0],D=e.resultSet.filter((function(e){return e})).length,k=e.resultSet.length,q=Math.floor(D/k*100);return function(e){var a=e.quizKey,n=e.split,t=e.quizScore;R.a.track("setQuizScore",{score:"".concat(a).concat(n).concat(t)})}({quizKey:e.quiz.key,split:e.jContent.score_splitPattern,quizScore:q}),Object(j.a)(Object(j.a)({},e),{},{currentSlide:x,showNext:t(Object(j.a)(Object(j.a)({},e),{},{slide:x})),showResult:!1,score:q});case"RESET":console.debug("[STORE] RESET");var I=e.slideSet.slice(0,1),T=Object(_.a)(I,1)[0];return console.debug("[STORE] RESET slideSet",e.slideSet),Object(j.a)(Object(j.a)({},e),{},{currentSlide:T,resultSet:[],showScore:!1,currentResult:!1,reset:!0});default:throw new Error("[STORE] action case '".concat(a.case,"' is unknown "))}},_e=function(e){var a=l.a.useReducer(Oe,e.jContent,we),n=Object(_.a)(a,2),t=n[0],r=n[1];return l.a.createElement(E.Provider,{value:{state:t,dispatch:r}},e.children)};n(131);window.quizUIApp=function(e,a){try{a=function(e){if(!Se.validate(he.context,e))throw{item:"Context configuration object",errors:Se.errors};return e.gql_variables.workspace=function(e){return"default"===e?"EDIT":e.toUpperCase()}(e.workspace),e.cnd_type=fe,e.consent_status=ye,e.quiz_validMark="[*]",e.score_splitPattern="::",e}(a);var n={};a.gql_authorization&&(n.Authorization=a.gql_authorization);var t=new w.a({uri:a.gql_endpoint,headers:n});s.a.render(l.a.createElement(_e,{jContent:a},l.a.createElement(Ee.a,{client:t},l.a.createElement(ge,null))),document.getElementById(e))}catch(r){console.error("error : ",r),s.a.render(l.a.createElement(ve,{item:r.item,errors:r.errors}),document.getElementById(e))}},"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},66:function(e,a,n){e.exports=n(132)},73:function(e,a,n){}},[[66,1,2]]]);
//# sourceMappingURL=main.9e7bfe14.chunk.js.map